attackerLocated(domain).
attackGoal(admin(domain)).
attackGoal(admin(host)).
attackGoal(dcSync(domain)).

hostDom(host, domain).

vulExists(domain, 'CVE-2022-26925', smb). /* Unauthent PetitPotam */
cvss('CVE-2022-26925', h).

/* MITM (Listen and relay) */
vulExists(host, 'CVE-2008-4037', host_to_admin). /* MS08-068 */
cvss('CVE-2008-4037', h).
/* vulExists(domain, 'CVE-2019-1040', dcSync). /* remove mic */
cvss('CVE-2019-1040', h).
vulExists(domain, 'CVE-2020-1472', dcSync). /* Zero-Logon */
cvss('CVE-2020-1472', h).

/* Classic quick compromission methods */
vulExists(host, 'CVE-2020-1472', host_to_admin). /* zerologon (unsafe) */
cvss('CVE-2020-1472', h).
vulExists(host, 'CVE-2017-0147', host_to_admin). /* Eternal Blue MS17-010 */
cvss('CVE-2017-0147', h).
/* vulExists(host, 'CVE-2014-1812', host_to_admin). /* SYSVOL & GPP MS14-025 */
cvss('CVE-2014-1812', h).

/* Known vulnerabilities */
/* vulExists(host, 'CVE-2014-6324', cred_to_admin).  *//* MS14-068 */
cvss('CVE-2014-6324', h).
/* vulExists(host, 'CVE-2019-0724', cred_to_admin). */ /* privexchange */
cvss('CVE-2019-0724', h).
/* vulExists(host, 'CVE-2019-0686', cred_to_admin). */ /* privexchange */
cvss('CVE-2019-0686', h).
vulExists(domain, 'CVE-2021-42287', cred_to_domadmin). /* SamAccountName */
cvss('CVE-2021-42287', h).
vulExists(domain, 'CVE-2021-42278', cred_to_domadmin). /* SamAccountName */
cvss('CVE-2021-42278', h).
/* vulExists(host, 'CVE-2021-1675', cred_to_admin). */ /* PrintNightmare */
cvss('CVE-2021-1675', h).
vulExists(host, 'CVE-2021-34527', cred_to_admin). /* PrintNightmare */
cvss('CVE-2021-34527', h).
vulExists(domain, 'CVE-2022-26923', cred_to_domadmin). /* Certifried */
cvss('CVE-2022-26923', h).

/* Privilege Escalation */
vulExists(host, 'CVE-2020-0796', low_to_admin). /* SMBGhost */
cvss('CVE-2020-0796', h).
/* vulExists(host, 'CVE-2021-36934', low_to_admin). */ /* HiveNightmare SeriousSAM */
cvss('CVE-2020-0796', h).
