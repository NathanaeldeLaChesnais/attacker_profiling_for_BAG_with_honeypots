:-(mvTrc(mitm(_h3279,0)),','(attackerLocated(_h3279),','(vulExists(_h3279,_h3290,smb),','(cvss(_h3290,_h3294),assert_trace(because(0,rule_desc('mitm attack is possible',cvss_ac(_h3294)),mitm(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,smb),attackerLocated(_h3279)])))))).

:-(mvTrc(localAdmin(_h3279,1)),','(mvTrc(mitm(_h3279,_h3331)),','(vulExists(_h3279,_h3290,ms_08_068),','(cvss(_h3290,_h3294),assert_trace(because(1,rule_desc('local admin access is possible',cvss_ac(_h3294)),localAdmin(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,ms_08_068),mitm(_h3279)])))))).

:-(mvTrc(dcSync(_h3279,2)),','(mvTrc(mitm(_h3279,_h3331)),','(vulExists(_h3279,_h3290,dcSync),','(cvss(_h3290,_h3294),assert_trace(because(2,rule_desc('dc sync attack is possible',cvss_ac(_h3294)),dcSync(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,dcSync),mitm(_h3279)])))))).

:-(mvTrc(vulnerableHost(_h3279,3)),','(attackerLocated(_h3281),assert_trace(because(3,rule_desc('host may be vulnerable',unlikely),vulnerableHost(_h3279),[attackerLocated(_h3281)])))).

:-(mvTrc(admin(_h3279,4)),','(attackerLocated(_h3284),','(vulExists(_h3279,_h3290,host_to_admin),','(cvss(_h3290,_h3294),assert_trace(because(4,rule_desc('cqc attack is possible against admin host or domain',cvss_ac(_h3294)),admin(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,host_to_admin),attackerLocated(_h3284)])))))).

:-(mvTrc(lowAccess(_h3279,5)),','(attackerLocated(domain),','(vulExists(_h3279,_h3290,vulnerableHost),','(cvss(_h3290,_h3294),assert_trace(because(5,rule_desc('low access is possible',cvss_ac(_h3294)),lowAccess(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,vulnerableHost),attackerLocated(domain)])))))).

:-(mvTrc(validCredentials(_h3279,6)),','(attackerLocated(_h3279),assert_trace(because(6,rule_desc('valid credentials may be found',likely),validCredentials(_h3279),[attackerLocated(_h3279)])))).

:-(mvTrc(passTheTicket(_h3279,7)),','(mvTrc(validCredentials(_h3279,_h3331)),','(vulExists(_h3279,_h3290,cred_to_ticket),','(cvss(_h3290,_h3294),assert_trace(because(7,rule_desc('domain admin access is possible',cvss_ac(_h3294)),passTheTicket(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,cred_to_ticket),validCredentials(_h3279)])))))).

:-(mvTrc(admin(_h3279,8)),','(mvTrc(validCredentials(_h3284,_h3337)),','(hostDom(_h3279,_h3284),','(vulExists(_h3279,_h3296,cred_to_admin),','(cvss(_h3296,_h3300),assert_trace(because(8,rule_desc('admin access is possible',cvss_ac(_h3300)),admin(_h3279),[cvss(_h3296,_h3300),vulExists(_h3279,_h3296,cred_to_admin),hostDom(_h3279,_h3284),validCredentials(_h3284)]))))))).

:-(mvTrc(admin(_h3279,9)),','(mvTrc(lowAccess(_h3279,_h3331)),','(vulExists(_h3279,_h3290,low_to_admin),','(cvss(_h3290,_h3294),assert_trace(because(9,rule_desc('privilege escalation',cvss_ac(_h3294)),admin(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,low_to_admin),lowAccess(_h3279)])))))).

:-(mvTrc(admin(_h3279,10)),','(mvTrc(dcSync(_h3279,_h3323)),','(vulExists(_h3279,_h3287,dcSync_to_domadmin),assert_trace(because(10,rule_desc('dc Sync',likely),admin(_h3279),[vulExists(_h3279,_h3287,dcSync_to_domadmin),dcSync(_h3279)]))))).

:-(mvTrc(dcSync(_h3279,11)),','(mvTrc(passTheTicket(_h3279,_h3323)),','(vulExists(_h3279,_h3287,passTicket_to_dcsync),assert_trace(because(11,rule_desc('lateral move to dcsync',likely),dcSync(_h3279),[vulExists(_h3279,_h3287,passTicket_to_dcsync),passTheTicket(_h3279)]))))).

:-(mvTrc(passTheTicket(_h3279,12)),','(mvTrc(mitm(_h3279,_h3323)),','(vulExists(_h3279,_h3287,adcs),assert_trace(because(12,rule_desc('ECS8 from http to pass the ticket',likely),passTheTicket(_h3279),[vulExists(_h3279,_h3287,adcs),mitm(_h3279)]))))).

