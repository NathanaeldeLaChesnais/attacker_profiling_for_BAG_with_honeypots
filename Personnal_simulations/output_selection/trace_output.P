primitive(attackerLocated,1).
primitive(vulExists,3).
primitive(hostDom,2).
derived(mitm,1).
derived(admin,1).
derived(dcSync,1).
derived(vulnerableHost,1).
derived(classicQCM,1).
derived(validCredentials,1).
derived(lowAccess,1).
derived(passTheTicket,1).
meta(attackGoal,1).
meta(cvss,2).

attack(admin(host)).

possible_duplicate_trace_step(because(6,rule_desc('valid credentials may be found',likely),validCredentials(domain),[attackerLocated(domain)])).

possible_duplicate_trace_step(because(8,rule_desc('admin access is possible',cvss_ac(h)),admin(host),[cvss('CVE-2019-0724',h),vulExists(host,'CVE-2019-0724',cred_to_admin),hostDom(host,domain),validCredentials(domain)])).

possible_duplicate_trace_step(because(5,rule_desc('low access is possible',cvss_ac(h)),lowAccess(host),[cvss('CVE-2021-44228',h),vulExists(host,'CVE-2021-44228',vulnerableHost),attackerLocated(domain)])).

possible_duplicate_trace_step(because(9,rule_desc('privilege escalation',cvss_ac(h)),admin(host),[cvss('CVE-2020-0796',h),vulExists(host,'CVE-2020-0796',low_to_admin),lowAccess(host)])).

attack(admin(host)).

