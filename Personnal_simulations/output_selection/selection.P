attackerLocated(domain).
attackGoal(admin(domain)).
attackGoal(admin(host)).

hostDom(host, domain).

vulExists(domain, 'CVE-2022-26925', smb). /* Unauthent PetitPotam */
cvss('CVE-2022-26925', h).

/* MITM (Listen and relay) */
vulExists(domain, 'CVE-2019-1040', coerceSMB_to_dcSync). /* remove mic */
cvss('CVE-2019-1040', h).
vulExists(domain, 'CVE-2020-1472', dcSync). /* Zero-Logon */
cvss('CVE-2020-1472', h).
vulExists(host, 'CVE-0000-4', coerce_http_to_admin). 

/* Classic quick compromission methods */
/* vulExists(host, 'CVE-2020-1472', host_to_admin). /* zerologon (unsafe) */
cvss('CVE-2020-1472', h).
/* vulExists(host, 'CVE-2014-1812', host_to_admin). /* SYSVOL & GPP MS14-025 */
cvss('CVE-2014-1812', h).
vulExists(host, 'CVE-2021-44228', vulnerableHost). /* Log4j */
cvss('CVE-2021-44228', h).

/* Known vulnerabilities */
vulExists(host, 'CVE-2019-0724', cred_to_coerce_http). /* privexchange */
cvss('CVE-2019-0724', h).
vulExists(domain, 'CVE-2021-42287', cred_to_ticket). /* SamAccountName */
cvss('CVE-2021-42287', h).
/* vulExists(host, 'CVE-2021-1675', cred_to_admin). /* PrintNightmare */
cvss('CVE-2021-1675', h).
/* vulExists(domain, 'CVE-2022-26923', cred_to_domadmin). /* Certifried */
cvss('CVE-2022-26923', h).

/* Privilege Escalation */
vulExists(host, 'CVE-2020-0796', low_to_admin). /* SMBGhost */
cvss('CVE-2020-0796', h).

/* Permissions move */
vulExists(domain, 'CVE-0000-1', dcSync_to_domadmin). /* dcSync */
cvss('CVE-0000-1', h).

/* Lateral move */
vulExists(domain, 'CVE-0000-2', passTicket_to_dcsync). /* MSHTML */
cvss('CVE-0000-2', h).

/* ADCS */
vulExists(domain, 'CVE-0000-3', adcs). /* ADCS */
cvss('CVE-0000-3', h).
