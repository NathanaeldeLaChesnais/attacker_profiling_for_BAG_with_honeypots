:-(mvTrc(stolenCredPriv(user,0)),','(mvTrc(stolenCred(_h3281,_h3325)),assert_trace(because(0,rule_desc('logic rule',certain),stolenCredPriv(user),[stolenCred(_h3281)])))).

:-(mvTrc(stolenCred(_h3279,1)),','(attackerLocated(_h3284),','(vulExists(_h3279,_h3287,bad_password),assert_trace(because(1,rule_desc('vulnerability exploit or default password',likely),stolenCred(_h3279),[vulExists(_h3279,_h3287,bad_password),attackerLocated(_h3284)]))))).

:-(mvTrc(corrupted(_h3279,2)),','(attackerLocated(_h3284),','(host(_h3279),','(vulExists(_h3279,_h3292,zero_day),assert_trace(because(2,rule_desc('zero day on machine',likely),corrupted(_h3279),[vulExists(_h3279,_h3292,zero_day),host(_h3279),attackerLocated(_h3284)])))))).

:-(mvTrc(corrupted(_h3279,3)),','(attackerLocated(_h3284),','(host(_h3279),','(vulExists(_h3279,_h3292,ntlm_bot),assert_trace(because(3,rule_desc('relai ntlm or coerce it',likely),corrupted(_h3279),[vulExists(_h3279,_h3292,ntlm_bot),host(_h3279),attackerLocated(_h3284)])))))).

:-(mvTrc(stolenHashNTLM(admin,4)),','(mvTrc(stolenCredPriv(user,_h3323)),','(vulExists(admin,_h3287,ntlm_hash),assert_trace(because(4,rule_desc('get ntlm hash',likely),stolenHashNTLM(admin),[vulExists(admin,_h3287,ntlm_hash),stolenCredPriv(user)]))))).

:-(mvTrc(corrupted(_h3279,5)),','(mvTrc(stolenHashNTLM(admin,_h3323)),','(vulExists(_h3279,_h3287,default_admin),assert_trace(because(5,rule_desc('pass the hash',likely),corrupted(_h3279),[vulExists(_h3279,_h3287,default_admin),stolenHashNTLM(admin)]))))).

:-(mvTrc(stolenHashKRB(_h3279,6)),','(mvTrc(stolenCredPriv(user,_h3323)),','(vulExists(_h3279,_h3287,kerberos),assert_trace(because(6,rule_desc('kerberoasting attack',cvss_ac_m),stolenHashKRB(_h3279),[vulExists(_h3279,_h3287,kerberos),stolenCredPriv(user)]))))).

:-(mvTrc(stolenCred(_h3279,7)),','(mvTrc(stolenHashKRB(_h3279,_h3323)),','(vulExists(_h3279,_h3287,cracking),assert_trace(because(7,rule_desc('kerberoasting attack',cvss_ac_m),stolenCred(_h3279),[vulExists(_h3279,_h3287,cracking),stolenHashKRB(_h3279)]))))).

:-(mvTrc(tgs(_h3279,8)),','(mvTrc(corrupted(_h3284,_h3324)),','(vulExists(_h3284,_h3279,_h3288,tgt),assert_trace(because(8,rule_desc('find a ticket',cap_l),tgs(_h3279),[vulExists(_h3284,_h3279,_h3288,tgt),corrupted(_h3284)]))))).

:-(mvTrc(corrupted(_h3279,9)),','(mvTrc(tgs(_h3279,_h3325)),assert_trace(because(9,rule_desc('pass the ticket',likely),corrupted(_h3279),[tgs(_h3279)])))).

:-(mvTrc(accessData(_h3279,10)),','(mvTrc(stolenCredPriv(_h3284,_h3324)),','(vulExists(_h3279,_h3284,_h3288,shares),assert_trace(because(10,rule_desc('network share',likely),accessData(_h3279),[vulExists(_h3279,_h3284,_h3288,shares),stolenCredPriv(_h3284)]))))).

:-(mvTrc(stolenCred(_h3279,11)),','(mvTrc(accessData(_h3284,_h3324)),','(vulExists(_h3284,_h3279,_h3288,clear_password),assert_trace(because(11,rule_desc('credential on a network share',cvss_ac_m),stolenCred(_h3279),[vulExists(_h3284,_h3279,_h3288,clear_password),accessData(_h3284)]))))).

:-(mvTrc(tgt(_h3279,12)),','(mvTrc(corrupted(_h3284,_h3331)),','(vulExists(_h3284,_h3290,non_constraint_delegation),','(vulExists(_h3284,_h3279,_h3290,asks_kerberos_ticket),assert_trace(because(12,rule_desc('privilege escalation',likely),tgt(_h3279),[vulExists(_h3284,_h3279,_h3290,asks_kerberos_ticket),vulExists(_h3284,_h3290,non_constraint_delegation),corrupted(_h3284)])))))).

:-(mvTrc(corrupted(_h3279,13)),','(mvTrc(tgt(_h3279,_h3325)),assert_trace(because(13,rule_desc('privilege escalation',cvss_ac_m),corrupted(_h3279),[tgt(_h3279)])))).

:-(mvTrc(stolenCred(_h3279,14)),','(mvTrc(corrupted(_h3284,_h3324)),','(vulExists(_h3284,_h3279,_h3288,credential_dump),assert_trace(because(14,rule_desc('secretdump or donpapi',likely),stolenCred(_h3279),[vulExists(_h3284,_h3279,_h3288,credential_dump),corrupted(_h3284)]))))).

:-(mvTrc(tgt(_h3279,15)),','(mvTrc(stolenCredPriv(user,_h3323)),','(vulExists(_h3279,_h3287,esc),assert_trace(because(15,rule_desc('certificat abuse',cvss_ac_m),tgt(_h3279),[vulExists(_h3279,_h3287,esc),stolenCredPriv(user)]))))).

:-(mvTrc(stolenCred(newAdmin,_h3280,16)),','(mvTrc(corrupted(_h3280,_h3324)),','(vulExists(_h3280,_h3288,newAdmin),assert_trace(because(16,rule_desc('persistence throug new account',cap_l),stolenCred(newAdmin,_h3280),[vulExists(_h3280,_h3288,newAdmin),corrupted(_h3280)]))))).

:-(mvTrc(tgt(dc,17)),','(mvTrc(corrupted(dc,_h3323)),','(vulExists(dc,_h3287,c),assert_trace(because(17,rule_desc('golden ticket',cvss_ac_m),tgt(dc),[vulExists(dc,_h3287,c),corrupted(dc)]))))).

:-(mvTrc(corrupted(fake_host,18)),','(mvTrc(tgs(_h3281,_h3325)),assert_trace(because(18,rule_desc('pass the ticket redirected',likely),corrupted(fake_host),[tgs(_h3281)])))).

