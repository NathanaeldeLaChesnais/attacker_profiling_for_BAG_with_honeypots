primitive(attackerLocated,1).
primitive(vulExists,3).
primitive(hostDom,2).
derived(mitm,1).
derived(admin,1).
derived(dcSync,1).
derived(vulnerableHost,1).
derived(classicQCM,1).
derived(validCredentials,1).
derived(lowAccess,1).
meta(attackGoal,1).
meta(cvss,2).

attack(admin(domain)).

possible_duplicate_trace_step(because(3,rule_desc('host may be vulnerable',unlikely),vulnerableHost(domain),[attackerLocated(domain)])).

possible_duplicate_trace_step(because(6,rule_desc('valid credentials may be found',likely),validCredentials(domain),[attackerLocated(domain)])).

possible_duplicate_trace_step(because(7,rule_desc('domain admin access is possible',cvss_ac(h)),admin(domain),[cvss('CVE-2021-42287',h),vulExists(domain,'CVE-2021-42287',cred_to_domadmin),validCredentials(domain)])).

possible_duplicate_trace_step(because(7,rule_desc('domain admin access is possible',cvss_ac(h)),admin(domain),[cvss('CVE-2021-42278',h),vulExists(domain,'CVE-2021-42278',cred_to_domadmin),validCredentials(domain)])).

possible_duplicate_trace_step(because(7,rule_desc('domain admin access is possible',cvss_ac(h)),admin(domain),[cvss('CVE-2022-26923',h),vulExists(domain,'CVE-2022-26923',cred_to_domadmin),validCredentials(domain)])).

possible_duplicate_trace_step(because(5,rule_desc('low access is possible',likely),lowAccess(domain),[vulnerableHost(domain)])).

possible_duplicate_trace_step(because(0,rule_desc('mitm attack is possible',cvss_ac(h)),mitm(domain),[cvss('CVE-2022-26925',h),vulExists(domain,'CVE-2022-26925',smb),attackerLocated(domain)])).

possible_duplicate_trace_step(because(2,rule_desc('dc sync attack is possible',cvss_ac(h)),dcSync(domain),[cvss('CVE-2019-1040',h),vulExists(domain,'CVE-2019-1040',dcSync),mitm(domain)])).

possible_duplicate_trace_step(because(2,rule_desc('dc sync attack is possible',cvss_ac(h)),dcSync(domain),[cvss('CVE-2020-1472',h),vulExists(domain,'CVE-2020-1472',dcSync),mitm(domain)])).

possible_duplicate_trace_step(because(2,rule_desc('dc sync attack is possible',cvss_ac(h)),dcSync(domain),[cvss('CVE-2020-1472',h),vulExists(domain,'CVE-2020-1472',dcSync),mitm(domain)])).

possible_duplicate_trace_step(because(6,rule_desc('valid credentials may be found',likely),validCredentials(domain),[attackerLocated(domain)])).

possible_duplicate_trace_step(because(10,rule_desc('permissions move',likely),admin(domain),[validCredentials(domain),dcSync(domain)])).

attack(admin(domain)).

attack(admin(domain)).

attack(admin(domain)).

attack(admin(domain)).

attack(admin(domain)).

attack(admin(host)).

possible_duplicate_trace_step(because(3,rule_desc('host may be vulnerable',unlikely),vulnerableHost(host),[attackerLocated(domain)])).

possible_duplicate_trace_step(because(4,rule_desc('classic quick compromission attack is possible against host or domain',cvss_ac(h)),admin(host),[cvss('CVE-2008-4037',h),vulExists(host,'CVE-2008-4037',host_to_admin),vulnerableHost(host)])).

possible_duplicate_trace_step(because(4,rule_desc('classic quick compromission attack is possible against host or domain',cvss_ac(h)),admin(host),[cvss('CVE-2020-1472',h),vulExists(host,'CVE-2020-1472',host_to_admin),vulnerableHost(host)])).

possible_duplicate_trace_step(because(4,rule_desc('classic quick compromission attack is possible against host or domain',cvss_ac(h)),admin(host),[cvss('CVE-2020-1472',h),vulExists(host,'CVE-2020-1472',host_to_admin),vulnerableHost(host)])).

possible_duplicate_trace_step(because(4,rule_desc('classic quick compromission attack is possible against host or domain',cvss_ac(h)),admin(host),[cvss('CVE-2017-0147',h),vulExists(host,'CVE-2017-0147',host_to_admin),vulnerableHost(host)])).

possible_duplicate_trace_step(because(4,rule_desc('classic quick compromission attack is possible against host or domain',cvss_ac(h)),admin(host),[cvss('CVE-2014-1812',h),vulExists(host,'CVE-2014-1812',host_to_admin),vulnerableHost(host)])).

possible_duplicate_trace_step(because(8,rule_desc('admin access is possible',cvss_ac(h)),admin(host),[cvss('CVE-2014-6324',h),vulExists(host,'CVE-2014-6324',cred_to_admin),hostDom(host,domain),validCredentials(domain)])).

possible_duplicate_trace_step(because(8,rule_desc('admin access is possible',cvss_ac(h)),admin(host),[cvss('CVE-2019-0724',h),vulExists(host,'CVE-2019-0724',cred_to_admin),hostDom(host,domain),validCredentials(domain)])).

possible_duplicate_trace_step(because(8,rule_desc('admin access is possible',cvss_ac(h)),admin(host),[cvss('CVE-2019-0686',h),vulExists(host,'CVE-2019-0686',cred_to_admin),hostDom(host,domain),validCredentials(domain)])).

possible_duplicate_trace_step(because(8,rule_desc('admin access is possible',cvss_ac(h)),admin(host),[cvss('CVE-2021-1675',h),vulExists(host,'CVE-2021-1675',cred_to_admin),hostDom(host,domain),validCredentials(domain)])).

possible_duplicate_trace_step(because(8,rule_desc('admin access is possible',cvss_ac(h)),admin(host),[cvss('CVE-2021-34527',h),vulExists(host,'CVE-2021-34527',cred_to_admin),hostDom(host,domain),validCredentials(domain)])).

possible_duplicate_trace_step(because(5,rule_desc('low access is possible',likely),lowAccess(host),[vulnerableHost(host)])).

possible_duplicate_trace_step(because(9,rule_desc('privilege escalation',cvss_ac(h)),admin(host),[cvss('CVE-2020-0796',h),vulExists(host,'CVE-2020-0796',low_to_admin),lowAccess(host)])).

possible_duplicate_trace_step(because(9,rule_desc('privilege escalation',cvss_ac(h)),admin(host),[cvss('CVE-2020-0796',h),vulExists(host,'CVE-2020-0796',low_to_admin),lowAccess(host)])).

attack(admin(host)).

attack(admin(host)).

attack(admin(host)).

attack(admin(host)).

attack(admin(host)).

attack(admin(host)).

attack(admin(host)).

attack(admin(host)).

attack(admin(host)).

attack(admin(host)).

attack(admin(host)).

attack(dcSync(domain)).

attack(dcSync(domain)).

attack(dcSync(domain)).

