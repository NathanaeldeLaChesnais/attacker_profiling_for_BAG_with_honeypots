attackerLocated(domain).
attackGoal(admin(domain)).
attackGoal(admin(local)).
attackGoal(admin(host)).
attackGoal(dcSync(domain)).

hostDom(host, domain).

vulExists(domain, smb, 'CVE-2022-26925'). /* Unauthent PetitPotam */
cvss('CVE-2022-26925', h).

vulExists(domain, ms_08_068, 'CVE-2008-4037'). /* MS08-068 */
cvss('CVE-2008-4037', h).

vulExists(domain, dcSync, 'CVE-2019-1040'). /* remove mic */
cvss('CVE-2019-1040', h).

vulExists(domain, dcSync, 'CVE-2020-1472'). /* Zero-Logon */
cvss('CVE-2020-1472', h).

/* Classic quick compromission methods */
vulExists(domain, host_to_admin, 'CVE-2021-1472'). /* zerologon (unsafe) */
cvss('CVE-2021-1472', h).
vulExists(domain, host_to_admin, 'CVE-2017-0147'). /* Eternal Blue MS17-010 */
cvss('CVE-2017-0147', h).
vulExists(domain, host_to_admin, 'CVE-2014-1812'). /* SYSVOL & GPP MS14-025 */
cvss('CVE-2014-1812', h).

/* Known vulnerabilities */
vulExists(host, cred_to_admin, 'CVE-2014-6324' ). /* MS14-068 */
cvss('CVE-2014-6324', h).
vulExists(host, cred_to_admin, 'CVE-2019-0724'). /* privexchange */
cvss('CVE-2019-0724', h).
vulExists(host, cred_to_admin, 'CVE-2019-0686'). /* privexchange */
cvss('CVE-2019-0686', h).
vulExists(domain, cred_to_domadmin, 'CVE-2021-42287'). /* SamAccountName */
cvss('CVE-2021-42287', h).
vulExists(domain, cred_to_domadmin, 'CVE-2021-42278'). /* SamAccountName */
cvss('CVE-2021-42278', h).
vulExists(host, cred_to_admin, 'CVE-2021-1675'). /* PrintNightmare */
cvss('CVE-2021-1675', h).
vulExists(host, cred_to_admin, 'CVE-2021-34527'). /* PrintNightmare */
cvss('CVE-2021-34527', h).
vulExists(domain, cred_to_domadmin, 'CVE-2022-26923'). /* Certifried */
cvss('CVE-2022-26923', h).

/* Privilege Escalation */
vulExists(host, low_to_admin, 'CVE-2020-0796'). /* SMBGhost */
cvss('CVE-2020-0796', h).
vulExists(host, low_to_admin, 'CVE-2021-36934'). /* HiveNightmare.SeriousSAM */
cvss('CVE-2020-0796', h).
