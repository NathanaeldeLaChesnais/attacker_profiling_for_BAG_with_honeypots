:-(mvTrc(execCode(_h3473,_h3474,0)),','(stolenCredential(_h3479,windows),','(hasAccount(_h3479,_h3473,_h3474),','(mvTrc(canAccessHost(_h3473,_h3543)),assert_trace(because(0,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',likely),execCode(_h3473,_h3474),[canAccessHost(_h3473),hasAccount(_h3479,_h3473,_h3474),stolenCredential(_h3479,windows)])))))).

:-(mvTrc(execCode(_h3473,root,1)),','(mvTrc(execCode(_h3473,_h3480,_h3529)),','(vulExists(_h3473,_h3486,_h3487,localExploit,privEscalation),','(cvss(_h3486,_h3492),assert_trace(because(1,rule_desc('local exploit',cvss_ac(_h3492)),execCode(_h3473,root),[cvss(_h3486,_h3492),vulExists(_h3473,_h3486,_h3487,localExploit,privEscalation),execCode(_h3473,_h3480)])))))).

:-(mvTrc(execCode(_h3473,_h3474,2)),','(vulExists(_h3473,_h3480,_h3481,remoteExploit,privEscalation),','(cvss(_h3480,_h3489),','(networkServiceInfo(_h3473,_h3481,_h3496,_h3497,_h3474),','(mvTrc(netAccess(_h3473,_h3496,_h3497,_h3563)),assert_trace(because(2,rule_desc('remote exploit of a server program',cvss_ac(_h3489)),execCode(_h3473,_h3474),[netAccess(_h3473,_h3496,_h3497),networkServiceInfo(_h3473,_h3481,_h3496,_h3497,_h3474),cvss(_h3480,_h3489),vulExists(_h3473,_h3480,_h3481,remoteExploit,privEscalation)]))))))).

:-(mvTrc(execCode(_h3473,_h3474,3)),','(vulExists(_h3473,_h3480,_h3481,remoteClient,privEscalation),','(cvss(_h3480,_h3489),','(hasAccount(_h3494,_h3473,_h3474),','(mvTrc(accessMaliciousInput(_h3473,_h3494,_h3481,_h3561)),assert_trace(because(3,rule_desc('remote exploit of a client program',cvss_ac(_h3489)),execCode(_h3473,_h3474),[accessMaliciousInput(_h3473,_h3494,_h3481),hasAccount(_h3494,_h3473,_h3474),cvss(_h3480,_h3489),vulExists(_h3473,_h3480,_h3481,remoteClient,privEscalation)]))))))).

:-(mvTrc(execCode(_h3473,root,4)),','(mvTrc(accessFile(_h3473,write,_h3478,_h3522)),assert_trace(because(4,rule_desc('Trojan horse installation',possible),execCode(_h3473,root),[accessFile(_h3473,write,_h3478)])))).

:-(mvTrc(netAccess(_h3473,_h3474,_h3475,5)),','(mvTrc(execCode(_h3480,_h3481,_h3527)),','(advances(_h3480,_h3473),','(hacl(_h3480,_h3473,_h3474,_h3475),assert_trace(because(5,rule_desc('multi-hop access',certain),netAccess(_h3473,_h3474,_h3475),[hacl(_h3480,_h3473,_h3474,_h3475),advances(_h3480,_h3473),execCode(_h3480,_h3481)])))))).

:-(mvTrc(netAccess(_h3473,_h3474,_h3475,6)),','(attackerLocated(_h3480),','(hacl(_h3480,_h3473,_h3474,_h3475),assert_trace(because(6,rule_desc('direct network access',certain),netAccess(_h3473,_h3474,_h3475),[hacl(_h3480,_h3473,_h3474,_h3475),attackerLocated(_h3480)]))))).

:-(mvTrc(netAccess(_h3473,_h3474,_h3475,7)),','(attackerLocated(_h3473),assert_trace(because(7,rule_desc('direct on-host access',certain),netAccess(_h3473,_h3474,_h3475),[attackerLocated(_h3473)])))).

:-(mvTrc(canAccessHost(_h3473,8)),','(mvTrc(execCode(_h3473,_h3476,_h3520)),assert_trace(because(8,rule_desc('Access a host through executing code on the machine',certain),canAccessHost(_h3473),[execCode(_h3473,_h3476)])))).

:-(mvTrc(canAccessHost(_h3473,9)),','(mvTrc(logInService(_h3473,_h3479,_h3480,_h3519)),','(mvTrc(netAccess(_h3473,_h3479,_h3480,_h3562)),assert_trace(because(9,rule_desc('Access a host through a log-in service',certain),canAccessHost(_h3473),[netAccess(_h3473,_h3479,_h3480),logInService(_h3473,_h3479,_h3480)]))))).

:-(mvTrc(accessFile(_h3473,_h3474,_h3475,10)),','(mvTrc(execCode(_h3473,_h3481,_h3521)),','(canAccessFile(_h3473,_h3481,_h3474,_h3475),assert_trace(because(10,rule_desc('execCode implies file access',certain),accessFile(_h3473,_h3474,_h3475),[canAccessFile(_h3473,_h3481,_h3474,_h3475),execCode(_h3473,_h3481)]))))).

:-(mvTrc(stolenCredential(_h3473,windows,11)),','(hasAccount(_h3473,_h3480,_h3481),','(mvTrc(execCode(_h3480,root,_h3533)),assert_trace(because(11,rule_desc('password sniffing',likely),stolenCredential(_h3473,windows),[execCode(_h3480,root),hasAccount(_h3473,_h3480,_h3481)]))))).

:-(mvTrc(logInService(_h3473,_h3474,_h3475,12)),','(networkServiceInfo(_h3473,sshd,_h3474,_h3475,_h3481),assert_trace(because(12,rule_desc('SSH is a login service',certain),logInService(_h3473,_h3474,_h3475),[networkServiceInfo(_h3473,sshd,_h3474,_h3475,_h3481)])))).

:-(mvTrc(logInService(_h3473,_h3474,_h3475,13)),','(networkServiceInfo(_h3473,vpnService,_h3474,_h3475,_h3481),assert_trace(because(13,rule_desc('VPN is a login service',certain),logInService(_h3473,_h3474,_h3475),[networkServiceInfo(_h3473,vpnService,_h3474,_h3475,_h3481)])))).

:-(mvTrc(accessFile(_h3473,_h3474,_h3475,14)),','(nfsMounted(_h3480,_h3481,_h3473,_h3475,_h3474),','(mvTrc(accessFile(_h3480,_h3474,_h3481,_h3537)),assert_trace(because(14,rule_desc('NFS semantics',certain),accessFile(_h3473,_h3474,_h3475),[accessFile(_h3480,_h3474,_h3481),nfsMounted(_h3480,_h3481,_h3473,_h3475,_h3474)]))))).

:-(mvTrc(accessFile(_h3473,_h3474,_h3475,15)),','(nfsMounted(_h3473,_h3475,_h3482,_h3483,read),','(mvTrc(accessFile(_h3482,_h3474,_h3483,_h3537)),assert_trace(because(15,rule_desc('NFS semantics',certain),accessFile(_h3473,_h3474,_h3475),[accessFile(_h3482,_h3474,_h3483),nfsMounted(_h3473,_h3475,_h3482,_h3483,read)]))))).

:-(mvTrc(accessFile(_h3473,_h3474,_h3475,16)),','(mvTrc(execCode(_h3480,_h3481,_h3529)),','(nfsExportInfo(_h3473,_h3475,_h3474,_h3480),','(hacl(_h3480,_h3473,nfsProtocol,nfsPort),assert_trace(because(16,rule_desc('NFS shell',likely),accessFile(_h3473,_h3474,_h3475),[hacl(_h3480,_h3473,nfsProtocol,nfsPort),nfsExportInfo(_h3473,_h3475,_h3474,_h3480),execCode(_h3480,_h3481)])))))).

:-(mvTrc(canAccessFile(_h3473,_h3474,_h3475,_h3476,17)),','(localFileProtection(_h3473,_h3474,_h3475,_h3476),assert_trace(because(17,rule_desc('file system access control',certain),canAccessFile(_h3473,_h3474,_h3475,_h3476),[localFileProtection(_h3473,_h3474,_h3475,_h3476)])))).

:-(mvTrc(vulExists(_h3473,_h3474,_h3475,_h3476,_h3477,18)),','(vulExists(_h3473,_h3474,_h3475),','(vulProperty(_h3474,_h3476,_h3477),assert_trace(because(18,rule_desc('La vulnérabilité a été déclarée manuellement',certain),vulExists(_h3473,_h3474,_h3475,_h3476,_h3477),[vulProperty(_h3474,_h3476,_h3477),vulExists(_h3473,_h3474,_h3475)]))))).

:-(mvTrc(vulExists(_h3473,_h3474,_h3475,_h3476,_h3477,19)),','(vulExists(_h3473,_h3474,_h3484,_h3476,_h3477),','(dependsOn(_h3473,_h3475,_h3484),assert_trace(because(19,rule_desc('Library bug',certain),vulExists(_h3473,_h3474,_h3475,_h3476,_h3477),[dependsOn(_h3473,_h3475,_h3484),vulExists(_h3473,_h3474,_h3484,_h3476,_h3477)]))))).

:-(mvTrc(accessMaliciousInput(_h3473,_h3474,_h3475,20)),','(inCompetent(_h3474),','(hacl(_h3473,_h3486,httpProtocol,httpPort),','(attackerLocated(_h3486),assert_trace(because(20,rule_desc('Browsing a malicious website',likely),accessMaliciousInput(_h3473,_h3474,_h3475),[attackerLocated(_h3486),hacl(_h3473,_h3486,httpProtocol,httpPort),inCompetent(_h3474)])))))).

:-(mvTrc(accessMaliciousInput(_h3473,_h3474,_h3475,21)),','(competent(_h3474),','(hacl(_h3473,_h3486,httpProtocol,httpPort),','(attackerLocated(_h3486),assert_trace(because(21,rule_desc('Browsing a malicious website',unlikely),accessMaliciousInput(_h3473,_h3474,_h3475),[attackerLocated(_h3486),hacl(_h3473,_h3486,httpProtocol,httpPort),competent(_h3474)])))))).

:-(mvTrc(accessMaliciousInput(_h3473,_h3474,_h3475,22)),','(inCompetent(_h3474),','(isWebServer(_h3485),','(hacl(_h3473,_h3485,httpProtocol,httpPort),','(mvTrc(execCode(_h3485,_h3496,_h3555)),assert_trace(because(22,rule_desc('Browsing a compromised website',possible),accessMaliciousInput(_h3473,_h3474,_h3475),[execCode(_h3485,_h3496),hacl(_h3473,_h3485,httpProtocol,httpPort),isWebServer(_h3485),inCompetent(_h3474)]))))))).

:-(mvTrc(userFound(_h3473,23)),','(userDefined(_h3473,_h3479,_h3480),','(mvTrc(netAccess(_h3479,_h3483,_h3484,_h3533)),assert_trace(because(23,rule_desc('User defined',certain),userFound(_h3473),[netAccess(_h3479,_h3483,_h3484),userDefined(_h3473,_h3479,_h3480)]))))).

:-(mvTrc(stolenCredential(_h3473,windows,24)),','(mvTrc(userFound(_h3473,_h3516)),','(inCompetent(_h3473),assert_trace(because(24,rule_desc('user is password',certain),stolenCredential(_h3473,windows),[inCompetent(_h3473),userFound(_h3473)]))))).

:-(mvTrc(stolenCredential(_h3473,windows,25)),','(mvTrc(userFound(_h3473,_h3521)),','(weakPassword(_h3473),','(hashFoundNTLM(_h3473),assert_trace(because(25,rule_desc('weak password crack',likely),stolenCredential(_h3473,windows),[hashFoundNTLM(_h3473),weakPassword(_h3473),userFound(_h3473)])))))).

:-(mvTrc(hasAccount(_h3473,_h3474,_h3475,26)),','(userDefined(_h3473,_h3481,_h3475),','(hostDefined(_h3474,_h3481),assert_trace(because(26,rule_desc('User defined',certain),hasAccount(_h3473,_h3474,_h3475),[hostDefined(_h3474,_h3481),userDefined(_h3473,_h3481,_h3475)]))))).

:-(mvTrc(execCode(_h3473,_h3474,_h3475,27)),','(hasAccount(_h3473,_h3474,_h3475),','(stolenCredential(_h3487,windows),','(hostDefined(_h3474,_h3494),','(mvTrc(netAccess(_h3494,_h3500,_h3501,_h3553)),','(rdpEnabled(_h3474),assert_trace(because(27,rule_desc('RDP access',certain),execCode(_h3473,_h3474,_h3475),[rdpEnabled(_h3474),netAccess(_h3494,_h3500,_h3501),hostDefined(_h3474,_h3494),stolenCredential(_h3487,windows),hasAccount(_h3473,_h3474,_h3475)])))))))).

:-(mvTrc(hashFoundNTLM(_h3473,28)),','(userPartOf(_h3473,runNTLMBot),','(isRuning(ntlmBot,_h3485),','(mvTrc(netAccess(_h3485,_h3488,_h3489,_h3543)),assert_trace(because(28,rule_desc('NTLM hash found',likely),hashFoundNTLM(_h3473),[netAccess(_h3485,_h3488,_h3489),isRuning(ntlmBot,_h3485),userPartOf(_h3473,runNTLMBot)])))))).

:-(mvTrc(stolenCredential(_h3473,_h3474,29)),','(credentialInClear(_h3473,_h3480,_h3474),','(mvTrc(netAccess(_h3480,_h3484,_h3485,_h3534)),assert_trace(because(29,rule_desc('Use of DonPAPI',likely),stolenCredential(_h3473,_h3474),[netAccess(_h3480,_h3484,_h3485),credentialInClear(_h3473,_h3480,_h3474)]))))).

:-(mvTrc(stolenHash(_h3473,_h3474,30)),','(hostProperty(_h3474,signedSMB,false),','(isConnected(_h3486,_h3474),','(userAdminOf(_h3486,_h3474),','(userLocalAccount(_h3473,_h3474),','(mvTrc(netAccess(_h3474,_h3502,_h3503,_h3567)),assert_trace(because(30,rule_desc('Use a socks relay with an admin account / part 4',likely),stolenHash(_h3473,_h3474),[netAccess(_h3474,_h3502,_h3503),userLocalAccount(_h3473,_h3474),userAdminOf(_h3486,_h3474),isConnected(_h3486,_h3474),hostProperty(_h3474,signedSMB,false)])))))))).

:-(mvTrc(isConnected(_h3473,_h3474,31)),','(hostDefined(_h3474,_h3480),','(userDefined(_h3473,_h3480,_h3484),assert_trace(because(31,rule_desc('Use a socks relay with an admin account / part 4',unlikely),isConnected(_h3473,_h3474),[userDefined(_h3473,_h3480,_h3484),hostDefined(_h3474,_h3480)]))))).

:-(mvTrc(userAdminOf(_h3473,_h3474,32)),','(userDefined(_h3473,_h3480,domain_admin),','(hostDefined(_h3474,_h3480),assert_trace(because(32,rule_desc('Un admin de domain est admin local des machines du domain',certain),userAdminOf(_h3473,_h3474),[hostDefined(_h3474,_h3480),userDefined(_h3473,_h3480,domain_admin)]))))).

:-(mvTrc(dnsPoisoning(_h3473,33)),','(hostProperty(_h3473,automaticDNS,true),','(mvTrc(netAccess(_h3473,_h3483,_h3484,_h3533)),assert_trace(because(33,rule_desc('dns Poisoning',likely),dnsPoisoning(_h3473),[netAccess(_h3473,_h3483,_h3484),hostProperty(_h3473,automaticDNS,true)]))))).

:-(mvTrc(relayWPAD(_h3473,34)),','(dnsPoisoning(_h3473),','(mvTrc(netAccess(_h3473,_h3481,_h3482,_h3531)),assert_trace(because(34,rule_desc('relay the wpad http query to the ldaps',likely),relayWPAD(_h3473),[netAccess(_h3473,_h3481,_h3482),dnsPoisoning(_h3473)]))))).

:-(mvTrc(hostDefined(_h3473,_h3474,35)),','(hostDefined(_h3479,_h3474),','(relayWPAD(_h3479),','(userAdminOf(attacker,_h3473),assert_trace(because(35,rule_desc('relay the wpad http query to the ldaps',likely),hostDefined(_h3473,_h3474),[userAdminOf(attacker,_h3473),relayWPAD(_h3479),hostDefined(_h3479,_h3474)])))))).

:-(mvTrc(stolenHash(_h3473,_h3474,36)),','(accessibleHash(_h3473,_h3474),assert_trace(because(36,rule_desc('Kerberoasting part3',likely),stolenHash(_h3473,_h3474),[accessibleHash(_h3473,_h3474)])))).

:-(mvTrc(stolenCredential(_h3473,_h3474,37)),','(stolenHash(_h3473,_h3474),','(halfCompetent(_h3473),assert_trace(because(37,rule_desc('Use of Hashcat',likely),stolenCredential(_h3473,_h3474),[halfCompetent(_h3473),stolenHash(_h3473,_h3474)]))))).

:-(mvTrc(halfCompetent(_h3473,38)),','(userDefined(_h3473,_h3476,_h3477),assert_trace(because(38,rule_desc('Use of Hashcat',likely),halfCompetent(_h3473),[userDefined(_h3473,_h3476,_h3477)])))).

:-(mvTrc(accessFile(_h3473,_h3474,39)),','(vulExists(_h3474,_h3480,_h3481,remoteExploit,fileAccess),','(fileOnHost(_h3473,_h3474),assert_trace(because(39,rule_desc('Remote access file',likely),accessFile(_h3473,_h3474),[fileOnHost(_h3473,_h3474),vulExists(_h3474,_h3480,_h3481,remoteExploit,fileAccess)]))))).

