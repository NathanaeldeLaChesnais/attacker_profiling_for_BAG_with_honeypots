:-(mvTrc(hash(_h3279,0)),','(mvTrc(hashNTLM(_h3279,_h3325)),assert_trace(because(0,rule_desc('hashntlm gives hash',likely),hash(_h3279),[hashNTLM(_h3279)])))).

:-(mvTrc(hash(_h3279,1)),','(mvTrc(hashKRB(_h3279,_h3325)),assert_trace(because(1,rule_desc('hashkrb gives hash',likely),hash(_h3279),[hashKRB(_h3279)])))).

:-(mvTrc(validUser(_h3279,2)),','(mvTrc(validCredential(_h3284,_h3321)),','(user(_h3284),assert_trace(because(2,rule_desc('rassemblement des comptes user en 1',certain),validUser(_h3279),[user(_h3284),validCredential(_h3284)]))))).

:-(mvTrc(hashNTLM(admin,3)),','(mvTrc(hashNTLM(domadmin,_h3325)),assert_trace(because(3,rule_desc('domadmin is admin',certain),hashNTLM(admin),[hashNTLM(domadmin)])))).

:-(mvTrc(coerceSMB(_h3279,4)),','(attackerLocated(_h3279),','(vulExists(_h3279,_h3290,smb),','(cvss(_h3290,_h3294),assert_trace(because(4,rule_desc('coerceSMB is possible',likely),coerceSMB(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,smb),attackerLocated(_h3279)])))))).

:-(mvTrc(userName(_h3279,5)),','(attackerLocated(_h3281),assert_trace(because(5,rule_desc('osint account',likely),userName(_h3279),[attackerLocated(_h3281)])))).

:-(mvTrc(hashNTLM(_h3279,6)),','(attackerLocated(_h3284),','(vulExists(_h3279,_h3287,ntlm_bot),assert_trace(because(6,rule_desc('responder gives netntlmv2 hashes from bots',likely),hashNTLM(_h3279),[vulExists(_h3279,_h3287,ntlm_bot),attackerLocated(_h3284)]))))).

:-(mvTrc(localAdmin(_h3279,7)),','(mvTrc(mitm(_h3279,_h3329)),','(vulExists(_h3279,_h3290,ms_08_068),','(cvss(_h3290,_h3294),assert_trace(because(7,rule_desc('local admin access is possible',likely),localAdmin(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,ms_08_068),mitm(_h3279)])))))).

:-(mvTrc(dcSync(_h3279,8)),','(mvTrc(coerceSMB(_h3279,_h3329)),','(vulExists(_h3279,_h3290,coerceSMB_to_dcSync),','(cvss(_h3290,_h3294),assert_trace(because(8,rule_desc('dc sync attack is possible from smb into ldap',likely),dcSync(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,coerceSMB_to_dcSync),coerceSMB(_h3279)])))))).

:-(mvTrc(socksNTLM(_h3279,9)),','(vulExists(_h3279,_h3282,unsigned_smb),assert_trace(because(9,rule_desc('SMB is not signed',likely),socksNTLM(_h3279),[vulExists(_h3279,_h3282,unsigned_smb)])))).

:-(mvTrc(vulnerableHost(_h3279,10)),','(attackerLocated(_h3281),assert_trace(because(10,rule_desc('host may be vulnerable',unlikely),vulnerableHost(_h3279),[attackerLocated(_h3281)])))).

:-(mvTrc(admin(_h3279,11)),','(attackerLocated(_h3284),','(vulExists(_h3279,_h3290,host_to_admin),','(cvss(_h3290,_h3294),assert_trace(because(11,rule_desc('cqc attack is possible against admin host or domain',likely),admin(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,host_to_admin),attackerLocated(_h3284)])))))).

:-(mvTrc(lowAccess(_h3279,12)),','(attackerLocated(domain),','(vulExists(_h3279,_h3290,vulnerableHost),','(cvss(_h3290,_h3294),assert_trace(because(12,rule_desc('low access is possible',likely),lowAccess(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,vulnerableHost),attackerLocated(domain)])))))).

:-(mvTrc(hash(_h3279,13)),','(mvTrc(userName(_h3279,_h3328)),','(attackerLocated(_h3289),','(vulExists(_h3279,_h3292,no_krb_preauth),assert_trace(because(13,rule_desc('hash found asrep',likely),hash(_h3279),[vulExists(_h3279,_h3292,no_krb_preauth),attackerLocated(_h3289),userName(_h3279)])))))).

:-(mvTrc(validCredential(_h3279,14)),','(mvTrc(hash(_h3279,_h3323)),','(vulExists(_h3279,_h3287,weak_hash),assert_trace(because(14,rule_desc('cracking hash',probable),validCredential(_h3279),[vulExists(_h3279,_h3287,weak_hash),hash(_h3279)]))))).

:-(mvTrc(passTheTicket(_h3279,15)),','(mvTrc(validCredential(_h3279,_h3329)),','(vulExists(_h3279,_h3290,cred_to_ticket),','(cvss(_h3290,_h3294),assert_trace(because(15,rule_desc('domain admin access is possible',likely),passTheTicket(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,cred_to_ticket),validCredential(_h3279)])))))).

:-(mvTrc(admin(_h3279,16)),','(mvTrc(validCredential(_h3284,_h3335)),','(hostDom(_h3279,_h3284),','(vulExists(_h3279,_h3296,cred_to_admin),','(cvss(_h3296,_h3300),assert_trace(because(16,rule_desc('admin access is possible',likely),admin(_h3279),[cvss(_h3296,_h3300),vulExists(_h3279,_h3296,cred_to_admin),hostDom(_h3279,_h3284),validCredential(_h3284)]))))))).

:-(mvTrc(coerceHTTP(_h3279,17)),','(mvTrc(validCredential(_h3284,_h3329)),','(vulExists(_h3279,_h3290,cred_to_coerce_http),','(cvss(_h3290,_h3294),assert_trace(because(17,rule_desc('cred_to_coerce_http attack is possible',likely),coerceHTTP(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,cred_to_coerce_http),validCredential(_h3284)])))))).

:-(mvTrc(admin(_h3279,18)),','(mvTrc(coerceHTTP(_h3279,_h3323)),','(vulExists(_h3279,_h3287,coerce_http_to_admin),assert_trace(because(18,rule_desc('admin access is possible',likely),admin(_h3279),[vulExists(_h3279,_h3287,coerce_http_to_admin),coerceHTTP(_h3279)]))))).

:-(mvTrc(admin(_h3279,19)),','(mvTrc(lowAccess(_h3279,_h3329)),','(vulExists(_h3279,_h3290,low_to_admin),','(cvss(_h3290,_h3294),assert_trace(because(19,rule_desc('privilege escalation',likely),admin(_h3279),[cvss(_h3290,_h3294),vulExists(_h3279,_h3290,low_to_admin),lowAccess(_h3279)])))))).

:-(mvTrc(admin(_h3279,20)),','(mvTrc(dcSync(_h3279,_h3323)),','(vulExists(_h3279,_h3287,dcSync_to_domadmin),assert_trace(because(20,rule_desc('dc Sync',likely),admin(_h3279),[vulExists(_h3279,_h3287,dcSync_to_domadmin),dcSync(_h3279)]))))).

:-(mvTrc(dcSync(_h3279,21)),','(mvTrc(passTheTicket(_h3279,_h3323)),','(vulExists(_h3279,_h3287,passTicket_to_dcsync),assert_trace(because(21,rule_desc('lateral move to dcsync',likely),dcSync(_h3279),[vulExists(_h3279,_h3287,passTicket_to_dcsync),passTheTicket(_h3279)]))))).

:-(mvTrc(admin(_h3279,22)),','(mvTrc(socksNTLM(_h3279,_h3328)),','(mvTrc(hashNTLM(admin,_h3352)),','(vulExists(_h3279,_h3292,ntlmsock_to_hostadmin),assert_trace(because(22,rule_desc('lateral move to host admin',likely),admin(_h3279),[vulExists(_h3279,_h3292,ntlmsock_to_hostadmin),hashNTLM(admin),socksNTLM(_h3279)])))))).

:-(mvTrc(passTheTicket(_h3279,23)),','(mvTrc(coerceHTTP(_h3279,_h3323)),','(vulExists(_h3279,_h3287,adcs),assert_trace(because(23,rule_desc('ECS8 from http to pass the ticket',likely),passTheTicket(_h3279),[vulExists(_h3279,_h3287,adcs),coerceHTTP(_h3279)]))))).

:-(mvTrc(hashKRB(_h3279,24)),','(mvTrc(validCredential(_h3284,_h3323)),','(vulExists(_h3279,_h3287,kerberoasting),assert_trace(because(24,rule_desc('kerberos attack',likely),hashKRB(_h3279),[vulExists(_h3279,_h3287,kerberoasting),validCredential(_h3284)]))))).

