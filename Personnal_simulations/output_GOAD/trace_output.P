primitive(inCompetent,1).
primitive(competent,1).
primitive(clientProgram,2).
primitive(vulExists,3).
primitive(vulProperty,3).
primitive(vulProperty,5).
primitive(hacl,4).
primitive(attackerLocated,1).
primitive(hasAccount,3).
primitive(networkServiceInfo,3).
primitive(setuidProgramInfo,3).
primitive(nfsExportInfo,4).
primitive(nfsMounted,5).
primitive(localFileProtection,4).
primitive(dependsOn,3).
primitive(installed,2).
primitive(isWebServer,1).
primitive(isUserMachine,1).
primitive(canAccessFile,4).
primitive(userDefined,3).
primitive(hostDefined,2).
primitive(rdpEnabled,1).
primitive(userPartOf,3).
primitive(weakPassword,1).
primitive(credentialInClear,3).
primitive(isRuning,2).
primitive(hostProperty,3).
primitive(isConnected,2).
primitive(userAdminOf,2).
primitive(accessibleHash,3).
primitive(fileOnHost,2).
primitive(amsiBypass,1).
primitive(cvss,2).
derived(execCode,2).
derived(netAccess,1).
derived(canAccessHost,1).
derived(accessFile,3).
derived(logInService,3).
derived(accessMaliciousInput,3).
derived(userFound,2).
derived(vulnExists,5).
derived(stolenCredential,2).
derived(stolenCredential,2).
derived(stolenCredential,2).
derived(dnsPoisoning,1).
derived(relayWPAD,1).
derived(stolenHash,2).
derived(hashFoundNTLM,1).
meta(cvss,2).
meta(attackGoal,1).

attack(stolenCredential(samwell_tarly,north_sevenkingdoms_local)).

possible_duplicate_trace_step(because(5,rule_desc('direct network access',certain),netAccess(_h3593),[hacl(intranet,_h3593,_h3664,_h3665),attackerLocated(intranet)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),[vulProperty('Enumerate DC properties anonymously',remoteExploit,accountEnumeration),vulExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),[vulProperty('Enumerate DC properties anonymously',remoteExploit,accountEnumeration),vulExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(samwell_tarly,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(5,rule_desc('direct network access',certain),netAccess(north_sevenkingdoms_local),[hacl(intranet,north_sevenkingdoms_local,_h3630,_h3631),attackerLocated(intranet)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(samwell_tarly,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(brandon_stark,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(samwell_tarly,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(hodor,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(jeor_mormont,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(jeor_mormont,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(robb_stark,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(robb_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(catelyn_stark,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(catelyn_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(jon_snow,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(eddard_stark,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(eddard_stark,north_sevenkingdoms_local,domain_admin)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(brandon_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(samwell_tarly,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(hodor,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(jeor_mormont,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(jeor_mormont,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(robb_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(robb_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(catelyn_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(catelyn_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(jon_snow,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(eddard_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(eddard_stark,north_sevenkingdoms_local,domain_admin)])).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(brandon_stark,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(brandon_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(24,rule_desc('asreproasting part2',likely),stolenHash(brandon_stark,north_sevenkingdoms_local),[userFound(brandon_stark,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(brandon_stark,north_sevenkingdoms_local,asreproasting)])).

possible_duplicate_trace_step(because(24,rule_desc('asreproasting part2',likely),stolenHash(brandon_stark,north_sevenkingdoms_local),[userFound(brandon_stark,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(brandon_stark,north_sevenkingdoms_local,asreproasting)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(samwell_tarly,north_sevenkingdoms_local),[inCompetent(samwell_tarly),userFound(samwell_tarly,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(hodor,north_sevenkingdoms_local),[inCompetent(hodor),userFound(hodor,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(samwell_tarly,north_sevenkingdoms_local),[inCompetent(samwell_tarly),userFound(samwell_tarly,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(hodor,north_sevenkingdoms_local),[inCompetent(hodor),userFound(hodor,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(27,rule_desc('Kerberoasting part3',likely),stolenHash(jon_snow,north_sevenkingdoms_local),[stolenCredential(samwell_tarly,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(jon_snow,north_sevenkingdoms_local,kerberoasting)])).

possible_duplicate_trace_step(because(27,rule_desc('Kerberoasting part3',likely),stolenHash(jon_snow,north_sevenkingdoms_local),[stolenCredential(hodor,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(jon_snow,north_sevenkingdoms_local,kerberoasting)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(brandon_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(brandon_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(eddard_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(eddard_stark,north_sevenkingdoms_local,domain_admin)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(eddard_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(eddard_stark,north_sevenkingdoms_local,domain_admin)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jon_snow,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jon_snow,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(catelyn_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(catelyn_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(catelyn_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(catelyn_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(robb_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(robb_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(robb_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(robb_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jeor_mormont,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(jeor_mormont,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jeor_mormont,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(jeor_mormont,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(hodor,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(hodor,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(samwell_tarly,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(samwell_tarly,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(brandon_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(brandon_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(24,rule_desc('asreproasting part2',likely),stolenHash(brandon_stark,north_sevenkingdoms_local),[userFound(brandon_stark,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(brandon_stark,north_sevenkingdoms_local,asreproasting)])).

possible_duplicate_trace_step(because(25,rule_desc('Use of Hashcat for password crack',likely),stolenCredential(brandon_stark,north_sevenkingdoms_local),[weakPassword(brandon_stark),stolenHash(brandon_stark,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(25,rule_desc('Use of Hashcat for password crack',likely),stolenCredential(jon_snow,north_sevenkingdoms_local),[weakPassword(jon_snow),stolenHash(jon_snow,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(hodor,north_sevenkingdoms_local),[inCompetent(hodor),userFound(hodor,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(samwell_tarly,north_sevenkingdoms_local),[inCompetent(samwell_tarly),userFound(samwell_tarly,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(27,rule_desc('Kerberoasting part3',likely),stolenHash(jon_snow,north_sevenkingdoms_local),[stolenCredential(brandon_stark,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(jon_snow,north_sevenkingdoms_local,kerberoasting)])).

possible_duplicate_trace_step(because(27,rule_desc('Kerberoasting part3',likely),stolenHash(jon_snow,north_sevenkingdoms_local),[stolenCredential(jon_snow,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(jon_snow,north_sevenkingdoms_local,kerberoasting)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(brandon_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(brandon_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(eddard_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(eddard_stark,north_sevenkingdoms_local,domain_admin)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(eddard_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(eddard_stark,north_sevenkingdoms_local,domain_admin)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jon_snow,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jon_snow,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(catelyn_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(catelyn_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(catelyn_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(catelyn_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(robb_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(robb_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(robb_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(robb_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jeor_mormont,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(jeor_mormont,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jeor_mormont,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(jeor_mormont,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(hodor,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(hodor,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(samwell_tarly,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(samwell_tarly,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(brandon_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(brandon_stark,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(brandon_stark,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(samwell_tarly,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(samwell_tarly,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(samwell_tarly,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(samwell_tarly,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(samwell_tarly,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(samwell_tarly,north_sevenkingdoms_local),[inCompetent(samwell_tarly),userFound(samwell_tarly,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(samwell_tarly,north_sevenkingdoms_local),[inCompetent(samwell_tarly),userFound(samwell_tarly,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(samwell_tarly,north_sevenkingdoms_local),[inCompetent(samwell_tarly),userFound(samwell_tarly,north_sevenkingdoms_local)])).

attack(stolenCredential(brandon_stark,north_sevenkingdoms_local)).

possible_duplicate_trace_step(because(24,rule_desc('asreproasting part2',likely),stolenHash(brandon_stark,north_sevenkingdoms_local),[userFound(brandon_stark,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(brandon_stark,north_sevenkingdoms_local,asreproasting)])).

possible_duplicate_trace_step(because(24,rule_desc('asreproasting part2',likely),stolenHash(brandon_stark,north_sevenkingdoms_local),[userFound(brandon_stark,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(brandon_stark,north_sevenkingdoms_local,asreproasting)])).

possible_duplicate_trace_step(because(24,rule_desc('asreproasting part2',likely),stolenHash(brandon_stark,north_sevenkingdoms_local),[userFound(brandon_stark,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(brandon_stark,north_sevenkingdoms_local,asreproasting)])).

possible_duplicate_trace_step(because(25,rule_desc('Use of Hashcat for password crack',likely),stolenCredential(brandon_stark,north_sevenkingdoms_local),[weakPassword(brandon_stark),stolenHash(brandon_stark,north_sevenkingdoms_local)])).

attack(stolenCredential(hodor,north_sevenkingdoms_local)).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(hodor,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(hodor,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(hodor,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(hodor,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(hodor,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(hodor,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(hodor,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(hodor,north_sevenkingdoms_local),[inCompetent(hodor),userFound(hodor,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(hodor,north_sevenkingdoms_local),[inCompetent(hodor),userFound(hodor,north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(23,rule_desc('password is user or in user description',certain),stolenCredential(hodor,north_sevenkingdoms_local),[inCompetent(hodor),userFound(hodor,north_sevenkingdoms_local)])).

attack(stolenCredential(jon_snow,north_sevenkingdoms_local)).

possible_duplicate_trace_step(because(21,rule_desc('User enumeration anonymously part2',cvss_ac(m)),userFound(jon_snow,north_sevenkingdoms_local),[cvss('Enumerate DC properties anonymously',m),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),netAccess(winterfell),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(22,rule_desc('Username found by brutforce',unlikely),userFound(jon_snow,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jon_snow,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(jon_snow,north_sevenkingdoms_local),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jon_snow,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(brandon_stark,north_sevenkingdoms_local),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jon_snow,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(hodor,north_sevenkingdoms_local),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(26,rule_desc('Username found after authentification',certain),userFound(jon_snow,north_sevenkingdoms_local),[netAccess(north_sevenkingdoms_local),stolenCredential(samwell_tarly,north_sevenkingdoms_local),userDefined(jon_snow,north_sevenkingdoms_local,user)])).

possible_duplicate_trace_step(because(27,rule_desc('Kerberoasting part3',likely),stolenHash(jon_snow,north_sevenkingdoms_local),[stolenCredential(jon_snow,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(jon_snow,north_sevenkingdoms_local,kerberoasting)])).

possible_duplicate_trace_step(because(27,rule_desc('Kerberoasting part3',likely),stolenHash(jon_snow,north_sevenkingdoms_local),[stolenCredential(brandon_stark,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(jon_snow,north_sevenkingdoms_local,kerberoasting)])).

possible_duplicate_trace_step(because(27,rule_desc('Kerberoasting part3',likely),stolenHash(jon_snow,north_sevenkingdoms_local),[stolenCredential(hodor,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(jon_snow,north_sevenkingdoms_local,kerberoasting)])).

possible_duplicate_trace_step(because(27,rule_desc('Kerberoasting part3',likely),stolenHash(jon_snow,north_sevenkingdoms_local),[stolenCredential(samwell_tarly,north_sevenkingdoms_local),netAccess(north_sevenkingdoms_local),accessibleHash(jon_snow,north_sevenkingdoms_local,kerberoasting)])).

possible_duplicate_trace_step(because(25,rule_desc('Use of Hashcat for password crack',likely),stolenCredential(jon_snow,north_sevenkingdoms_local),[weakPassword(jon_snow),stolenHash(jon_snow,north_sevenkingdoms_local)])).

