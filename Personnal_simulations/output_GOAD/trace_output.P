primitive(attackerLocated,1).
primitive(vulExists,3).
primitive(hostDom,2).
derived(mitm,1).
derived(admin,1).
derived(dcSync,1).
derived(vulnerableHost,1).
derived(classicQCM,1).
derived(validCredentials,1).
derived(lowAccess,1).
derived(passTheTicket,1).
derived(coerceHTTP,1).
derived(coerceSMB,1).
derived(userName,1).
derived(hash,1).
derived(hashNTLM,1).
meta(attackGoal,1).
meta(cvss,2).

attack(validCredentials(user1)).

possible_duplicate_trace_step(because(3,rule_desc('responder gives netntlmv2 hashes from bots',likely),hashNTLM(user1),[vulExists(user1,'CVE-0000-7',ntlm_bot),attackerLocated(intranet)])).

possible_duplicate_trace_step(because(0,rule_desc('hashntlm gives hash',likely),hash(user1),[hashNTLM(user1)])).

possible_duplicate_trace_step(because(2,rule_desc('osint account',likely),userName(user1),[attackerLocated(intranet)])).

possible_duplicate_trace_step(because(10,rule_desc('cracking hash',probable),validCredentials(user1),[vulExists(user1,'CVE-0000-8',weak_hash),hash(user1)])).

attack(validCredentials(user)).

possible_duplicate_trace_step(because(2,rule_desc('osint account',likely),userName(user),[attackerLocated(intranet)])).

possible_duplicate_trace_step(because(9,rule_desc('hash found asrep',likely),hash(user),[vulExists(user,'CVE-0000-6',no_krb_preauth),userName(user)])).

possible_duplicate_trace_step(because(10,rule_desc('cracking hash',probable),validCredentials(user),[vulExists(user,'CVE-0000-5',weak_hash),hash(user)])).

