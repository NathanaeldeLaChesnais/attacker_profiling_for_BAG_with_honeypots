primitive(inCompetent,1).
primitive(competent,1).
primitive(clientProgram,2).
primitive(vulExists,3).
primitive(vulProperty,3).
primitive(vulProperty,5).
primitive(hacl,4).
primitive(attackerLocated,1).
primitive(hasAccount,3).
primitive(networkServiceInfo,3).
primitive(setuidProgramInfo,3).
primitive(nfsExportInfo,4).
primitive(nfsMounted,5).
primitive(localFileProtection,4).
primitive(dependsOn,3).
primitive(installed,2).
primitive(isWebServer,1).
primitive(isUserMachine,1).
primitive(canAccessFile,4).
primitive(userDefined,3).
primitive(hostDefined,2).
primitive(rdpEnabled,1).
primitive(userPartOf,3).
primitive(weakPassword,1).
primitive(credentialInClear,3).
primitive(isRuning,2).
primitive(hostProperty,3).
primitive(isConnected,2).
primitive(userAdminOf,2).
primitive(accessibleHash,3).
primitive(fileOnHost,2).
primitive(amsiBypass,1).
primitive(cvss,2).
derived(execCode,2).
derived(netAccess,1).
derived(canAccessHost,1).
derived(accessFile,3).
derived(logInService,3).
derived(accessMaliciousInput,3).
derived(userFound,2).
derived(vulnExists,5).
derived(stolenCredential,2).
derived(stolenCredentialDC,2).
derived(dnsPoisoning,1).
derived(relayWPAD,1).
derived(stolenHash,2).
derived(hashFoundNTLM,1).
meta(cvss,2).
meta(attackGoal,1).

attack(execCode(meereen,root)).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(castelblack,'MSSQL',mssql,remoteExploit,privEscalation),[vulProperty('MSSQL',remoteExploit,privEscalation),vulExists(castelblack,'MSSQL',mssql)])).

possible_duplicate_trace_step(because(5,rule_desc('direct network access',certain),netAccess(castelblack),[hacl(intranet,castelblack,_h3914,_h3915),attackerLocated(intranet)])).

possible_duplicate_trace_step(because(2,rule_desc('remote exploit of a server program',cvss_ac(h)),execCode(castelblack,shell),[netAccess(castelblack),networkServiceInfo(castelblack,mssql,shell),cvss('MSSQL',h),vulnExists(castelblack,'MSSQL',mssql,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(meereen,'CVE-2022-26923',certifried,remoteExploit,privEscalation),[vulProperty('CVE-2022-26923',remoteExploit,privEscalation),vulExists(meereen,'CVE-2022-26923',certifried)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(braavos,'MSSQL',mssql,remoteExploit,privEscalation),[vulProperty('MSSQL',remoteExploit,privEscalation),vulExists(braavos,'MSSQL',mssql)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(castelblack,'MSSQL',mssql,remoteExploit,privEscalation),[vulProperty('MSSQL',remoteExploit,privEscalation),vulExists(castelblack,'MSSQL',mssql)])).

possible_duplicate_trace_step(because(2,rule_desc('remote exploit of a server program',cvss_ac(h)),execCode(castelblack,shell),[netAccess(castelblack),networkServiceInfo(castelblack,mssql,shell),cvss('MSSQL',h),vulnExists(castelblack,'MSSQL',mssql,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(5,rule_desc('direct network access',certain),netAccess(braavos),[hacl(intranet,braavos,_h4236,_h4237),attackerLocated(intranet)])).

possible_duplicate_trace_step(because(2,rule_desc('remote exploit of a server program',cvss_ac(h)),execCode(braavos,shell),[netAccess(braavos),networkServiceInfo(braavos,mssql,shell),cvss('MSSQL',h),vulnExists(braavos,'MSSQL',mssql,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(5,rule_desc('direct network access',certain),netAccess(meereen),[hacl(intranet,meereen,_h4236,_h4237),attackerLocated(intranet)])).

possible_duplicate_trace_step(because(2,rule_desc('remote exploit of a server program',cvss_ac(h)),execCode(meereen,shell),[netAccess(meereen),networkServiceInfo(meereen,certifried,shell),cvss('CVE-2022-26923',h),vulnExists(meereen,'CVE-2022-26923',certifried,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(winterfell,'CVE-2021-1675',spooler,remoteExploitWithAccount,privEscalation),[vulProperty('CVE-2021-1675',remoteExploitWithAccount,privEscalation),vulExists(winterfell,'CVE-2021-1675',spooler)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(meereen,'CVE-2021-1675',spooler,remoteExploitWithAccount,privEscalation),[vulProperty('CVE-2021-1675',remoteExploitWithAccount,privEscalation),vulExists(meereen,'CVE-2021-1675',spooler)])).

possible_duplicate_trace_step(because(5,rule_desc('direct network access',certain),netAccess(_h4499),[hacl(intranet,_h4499,_h4571,_h4572),attackerLocated(intranet)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local,remoteExploit,accountEnumeration),[vulProperty('Enumerate DC properties anonymously',remoteExploit,accountEnumeration),vulExists(winterfell,'Enumerate DC properties anonymously',north_sevenkingdoms_local)])).

possible_duplicate_trace_step(because(24,rule_desc('Username found by brutforce',unlikely),userFound(jorah_mormont,meereen),[netAccess(meereen),userDefined(jorah_mormont,meereen,user)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash),[vulProperty('CVE-2021-42287',remoteExploit,accessLocalHash),vulExists(winterfell,'CVE-2021-42287',active_Directory)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash),[vulProperty('CVE-2021-42287',remoteExploit,accessLocalHash),vulExists(winterfell,'CVE-2021-42287',active_Directory)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(meereen,'CVE-2019-1040',removeTheMic,remoteExploit,accessLocalHash),[vulProperty('CVE-2019-1040',remoteExploit,accessLocalHash),vulExists(meereen,'CVE-2019-1040',removeTheMic)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(meereen,'ESC8',webEnrollementEnabled,remoteExploit,accessLocalHash),[vulProperty('ESC8',remoteExploit,accessLocalHash),vulExists(meereen,'ESC8',webEnrollementEnabled)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(meereen,'ESC1',certification,remoteExploit,accessLocalHash),[vulProperty('ESC1',remoteExploit,accessLocalHash),vulExists(meereen,'ESC1',certification)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(meereen,'ESC2',certification,remoteExploit,accessLocalHash),[vulProperty('ESC2',remoteExploit,accessLocalHash),vulExists(meereen,'ESC2',certification)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(meereen,'ESC3',certification,remoteExploit,accessLocalHash),[vulProperty('ESC3',remoteExploit,accessLocalHash),vulExists(meereen,'ESC3',certification)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(meereen,'ShadowCredential',essos_local,remoteExploit,accessLocalHash),[vulProperty('ShadowCredential',remoteExploit,accessLocalHash),vulExists(meereen,'ShadowCredential',essos_local)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('ShadowCredential',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'ShadowCredential',essos_local,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(guest,meereen),[netAccess(meereen),cvss('ShadowCredential',h),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'ShadowCredential',essos_local,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('ShadowCredential',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'ShadowCredential',essos_local,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('ShadowCredential',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'ShadowCredential',essos_local,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(guest,meereen),[netAccess(meereen),cvss('ShadowCredential',h),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'ShadowCredential',essos_local,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('ShadowCredential',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'ShadowCredential',essos_local,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(daenerys_targaryen,meereen),[netAccess(meereen),cvss('ShadowCredential',h),accessibleHash(daenerys_targaryen,meereen,meereen),vulnExists(meereen,'ShadowCredential',essos_local,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('ShadowCredential',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'ShadowCredential',essos_local,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('ShadowCredential',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'ShadowCredential',essos_local,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('ESC3',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'ESC3',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(guest,meereen),[netAccess(meereen),cvss('ESC3',h),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'ESC3',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('ESC3',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'ESC3',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('ESC3',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'ESC3',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(guest,meereen),[netAccess(meereen),cvss('ESC3',h),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'ESC3',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('ESC3',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'ESC3',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(daenerys_targaryen,meereen),[netAccess(meereen),cvss('ESC3',h),accessibleHash(daenerys_targaryen,meereen,meereen),vulnExists(meereen,'ESC3',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('ESC3',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'ESC3',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('ESC3',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'ESC3',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('ESC2',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'ESC2',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(guest,meereen),[netAccess(meereen),cvss('ESC2',h),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'ESC2',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('ESC2',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'ESC2',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('ESC2',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'ESC2',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(guest,meereen),[netAccess(meereen),cvss('ESC2',h),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'ESC2',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('ESC2',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'ESC2',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(daenerys_targaryen,meereen),[netAccess(meereen),cvss('ESC2',h),accessibleHash(daenerys_targaryen,meereen,meereen),vulnExists(meereen,'ESC2',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('ESC2',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'ESC2',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('ESC2',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'ESC2',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('ESC1',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'ESC1',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(guest,meereen),[netAccess(meereen),cvss('ESC1',h),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'ESC1',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('ESC1',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'ESC1',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('ESC1',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'ESC1',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(guest,meereen),[netAccess(meereen),cvss('ESC1',h),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'ESC1',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('ESC1',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'ESC1',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(daenerys_targaryen,meereen),[netAccess(meereen),cvss('ESC1',h),accessibleHash(daenerys_targaryen,meereen,meereen),vulnExists(meereen,'ESC1',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('ESC1',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'ESC1',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('ESC1',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'ESC1',certification,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('ESC8',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'ESC8',webEnrollementEnabled,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(guest,meereen),[netAccess(meereen),cvss('ESC8',h),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'ESC8',webEnrollementEnabled,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('ESC8',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'ESC8',webEnrollementEnabled,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('ESC8',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'ESC8',webEnrollementEnabled,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(guest,meereen),[netAccess(meereen),cvss('ESC8',h),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'ESC8',webEnrollementEnabled,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('ESC8',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'ESC8',webEnrollementEnabled,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(daenerys_targaryen,meereen),[netAccess(meereen),cvss('ESC8',h),accessibleHash(daenerys_targaryen,meereen,meereen),vulnExists(meereen,'ESC8',webEnrollementEnabled,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('ESC8',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'ESC8',webEnrollementEnabled,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('ESC8',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'ESC8',webEnrollementEnabled,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(m)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('CVE-2019-1040',m),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'CVE-2019-1040',removeTheMic,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(m)),stolenHash(guest,meereen),[netAccess(meereen),cvss('CVE-2019-1040',m),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'CVE-2019-1040',removeTheMic,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(m)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('CVE-2019-1040',m),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'CVE-2019-1040',removeTheMic,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(m)),stolenHash(localAdmin,meereen),[netAccess(meereen),cvss('CVE-2019-1040',m),accessibleHash(localAdmin,meereen,meereen),vulnExists(meereen,'CVE-2019-1040',removeTheMic,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(m)),stolenHash(guest,meereen),[netAccess(meereen),cvss('CVE-2019-1040',m),accessibleHash(guest,meereen,meereen),vulnExists(meereen,'CVE-2019-1040',removeTheMic,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(m)),stolenHash(defaultAccount,meereen),[netAccess(meereen),cvss('CVE-2019-1040',m),accessibleHash(defaultAccount,meereen,meereen),vulnExists(meereen,'CVE-2019-1040',removeTheMic,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(m)),stolenHash(daenerys_targaryen,meereen),[netAccess(meereen),cvss('CVE-2019-1040',m),accessibleHash(daenerys_targaryen,meereen,meereen),vulnExists(meereen,'CVE-2019-1040',removeTheMic,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(m)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('CVE-2019-1040',m),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'CVE-2019-1040',removeTheMic,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(42,rule_desc('remote access hash',cvss_ac(m)),stolenHash(jorah_mormont,meereen),[netAccess(meereen),cvss('CVE-2019-1040',m),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(meereen,'CVE-2019-1040',removeTheMic,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(27,rule_desc('Use of Hashcat for password crack',likely),stolenCredential(jorah_mormont,meereen),[weakPassword(jorah_mormont),stolenHash(jorah_mormont,meereen)])).

possible_duplicate_trace_step(because(40,rule_desc('stolen hash for a full domain',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[stolenCredential(jorah_mormont,meereen),cvss('CVE-2021-42287',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(40,rule_desc('stolen hash for a full domain',cvss_ac(h)),stolenHash(jorah_mormont,meereen),[stolenCredential(jorah_mormont,meereen),cvss('CVE-2021-42287',h),accessibleHash(jorah_mormont,meereen,meereen),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(40,rule_desc('stolen hash for a full domain',cvss_ac(h)),stolenHash(daenerys_targaryen,meereen),[stolenCredential(jorah_mormont,meereen),cvss('CVE-2021-42287',h),accessibleHash(daenerys_targaryen,meereen,meereen),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(40,rule_desc('stolen hash for a full domain',cvss_ac(h)),stolenHash(defaultAccount,meereen),[stolenCredential(jorah_mormont,meereen),cvss('CVE-2021-42287',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(40,rule_desc('stolen hash for a full domain',cvss_ac(h)),stolenHash(guest,meereen),[stolenCredential(jorah_mormont,meereen),cvss('CVE-2021-42287',h),accessibleHash(guest,meereen,meereen),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(40,rule_desc('stolen hash for a full domain',cvss_ac(h)),stolenHash(localAdmin,meereen),[stolenCredential(jorah_mormont,meereen),cvss('CVE-2021-42287',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(40,rule_desc('stolen hash for a full domain',cvss_ac(h)),stolenHash(defaultAccount,meereen),[stolenCredential(jorah_mormont,meereen),cvss('CVE-2021-42287',h),accessibleHash(defaultAccount,meereen,meereen),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(40,rule_desc('stolen hash for a full domain',cvss_ac(h)),stolenHash(guest,meereen),[stolenCredential(jorah_mormont,meereen),cvss('CVE-2021-42287',h),accessibleHash(guest,meereen,meereen),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(40,rule_desc('stolen hash for a full domain',cvss_ac(h)),stolenHash(localAdmin,meereen),[stolenCredential(jorah_mormont,meereen),cvss('CVE-2021-42287',h),accessibleHash(localAdmin,meereen,meereen),vulnExists(winterfell,'CVE-2021-42287',active_Directory,remoteExploit,accessLocalHash)])).

possible_duplicate_trace_step(because(28,rule_desc('Username found after authentification',certain),userFound(jorah_mormont,meereen),[netAccess(meereen),stolenCredential(jorah_mormont,meereen),userDefined(jorah_mormont,meereen,user)])).

possible_duplicate_trace_step(because(27,rule_desc('Use of Hashcat for password crack',likely),stolenCredential(jorah_mormont,meereen),[weakPassword(jorah_mormont),stolenHash(jorah_mormont,meereen)])).

possible_duplicate_trace_step(because(41,rule_desc('remote exploit of a server with account',cvss_ac(h)),execCode(meereen,_h3934),[netAccess(meereen),stolenCredential(jorah_mormont,meereen),networkServiceInfo(meereen,spooler,_h3934),cvss('CVE-2021-1675',h),vulnExists(meereen,'CVE-2021-1675',spooler,remoteExploitWithAccount,privEscalation)])).

possible_duplicate_trace_step(because(5,rule_desc('direct network access',certain),netAccess(winterfell),[hacl(intranet,winterfell,_h4615,_h4616),attackerLocated(intranet)])).

possible_duplicate_trace_step(because(24,rule_desc('Username found by brutforce',unlikely),userFound(eddard_stark,winterfell),[netAccess(winterfell),userDefined(eddard_stark,winterfell,admin)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(winterfell,'CVE-2021-1675',spooler,remoteExploitWithAccount,privEscalation),[vulProperty('CVE-2021-1675',remoteExploitWithAccount,privEscalation),vulExists(winterfell,'CVE-2021-1675',spooler)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(meereen,'CVE-2022-26923',certifried,remoteExploit,privEscalation),[vulProperty('CVE-2022-26923',remoteExploit,privEscalation),vulExists(meereen,'CVE-2022-26923',certifried)])).

possible_duplicate_trace_step(because(2,rule_desc('remote exploit of a server program',cvss_ac(h)),execCode(meereen,shell),[netAccess(meereen),networkServiceInfo(meereen,certifried,shell),cvss('CVE-2022-26923',h),vulnExists(meereen,'CVE-2022-26923',certifried,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(16,rule_desc('Vuln declared',certain),vulnExists(meereen,'CVE-2021-1675',spooler,remoteExploitWithAccount,privEscalation),[vulProperty('CVE-2021-1675',remoteExploitWithAccount,privEscalation),vulExists(meereen,'CVE-2021-1675',spooler)])).

possible_duplicate_trace_step(because(41,rule_desc('remote exploit of a server with account',cvss_ac(h)),execCode(meereen,_h3674),[netAccess(meereen),stolenCredential(jorah_mormont,meereen),networkServiceInfo(meereen,spooler,_h3674),cvss('CVE-2021-1675',h),vulnExists(meereen,'CVE-2021-1675',spooler,remoteExploitWithAccount,privEscalation)])).

possible_duplicate_trace_step(because(41,rule_desc('remote exploit of a server with account',cvss_ac(h)),execCode(meereen,root),[netAccess(meereen),stolenCredential(jorah_mormont,meereen),networkServiceInfo(meereen,spooler,root),cvss('CVE-2021-1675',h),vulnExists(meereen,'CVE-2021-1675',spooler,remoteExploitWithAccount,privEscalation)])).

