:-(mvTrc(execCode(_h3279,_h3280,0)),','(mvTrc(stolenCredential(_h3285,windows,_h3330)),','(hasAccount(_h3285,_h3279,_h3280),','(mvTrc(canAccessHost(_h3279,_h3373)),assert_trace(because(0,rule_desc('When a principal is compromised any machine he has an account on will also be compromised',likely),execCode(_h3279,_h3280),[canAccessHost(_h3279),hasAccount(_h3285,_h3279,_h3280),stolenCredential(_h3285,windows)])))))).

:-(mvTrc(execCode(_h3279,root,1)),','(mvTrc(execCode(_h3279,_h3286,_h3335)),','(mvTrc(vulnExists(_h3279,_h3292,_h3293,localExploit,privEscalation,_h3364)),','(cvss(_h3292,_h3298),assert_trace(because(1,rule_desc('local exploit',cvss_ac(_h3298)),execCode(_h3279,root),[cvss(_h3292,_h3298),vulnExists(_h3279,_h3292,_h3293,localExploit,privEscalation),execCode(_h3279,_h3286)])))))).

:-(mvTrc(execCode(_h3279,_h3280,2)),','(mvTrc(vulnExists(_h3279,_h3286,_h3287,remoteExploit,privEscalation,_h3341)),','(cvss(_h3286,_h3295),','(networkServiceInfo(_h3279,_h3287,_h3280),','(mvTrc(netAccess(_h3279,_h3404)),assert_trace(because(2,rule_desc('remote exploit of a server program',cvss_ac(_h3295)),execCode(_h3279,_h3280),[netAccess(_h3279),networkServiceInfo(_h3279,_h3287,_h3280),cvss(_h3286,_h3295),vulnExists(_h3279,_h3286,_h3287,remoteExploit,privEscalation)]))))))).

:-(mvTrc(execCode(_h3279,_h3280,3)),','(mvTrc(vulnExists(_h3279,_h3286,_h3287,remoteClient,privEscalation,_h3343)),','(cvss(_h3286,_h3295),','(hasAccount(_h3300,_h3279,_h3280),','(mvTrc(accessMaliciousInput(_h3279,_h3300,_h3287,_h3406)),assert_trace(because(3,rule_desc('remote exploit of a client program',cvss_ac(_h3295)),execCode(_h3279,_h3280),[accessMaliciousInput(_h3279,_h3300,_h3287),hasAccount(_h3300,_h3279,_h3280),cvss(_h3286,_h3295),vulnExists(_h3279,_h3286,_h3287,remoteClient,privEscalation)]))))))).

:-(mvTrc(execCode(_h3279,root,4)),','(mvTrc(accessFile(_h3279,write,_h3284,_h3328)),assert_trace(because(4,rule_desc('Trojan horse installation',possible),execCode(_h3279,root),[accessFile(_h3279,write,_h3284)])))).

:-(mvTrc(netAccess(_h3279,5)),','(attackerLocated(_h3284),','(hacl(_h3284,_h3279,_h3288,_h3289),assert_trace(because(5,rule_desc('direct network access',certain),netAccess(_h3279),[hacl(_h3284,_h3279,_h3288,_h3289),attackerLocated(_h3284)]))))).

:-(mvTrc(canAccessHost(_h3279,6)),','(mvTrc(execCode(_h3279,_h3282,_h3326)),assert_trace(because(6,rule_desc('Access a host through executing code on the machine',certain),canAccessHost(_h3279),[execCode(_h3279,_h3282)])))).

:-(mvTrc(canAccessHost(_h3279,7)),','(mvTrc(logInService(_h3279,_h3285,_h3286,_h3323)),','(mvTrc(netAccess(_h3279,_h3366)),assert_trace(because(7,rule_desc('Access a host through a log-in service',certain),canAccessHost(_h3279),[netAccess(_h3279),logInService(_h3279,_h3285,_h3286)]))))).

:-(mvTrc(accessFile(_h3279,_h3280,_h3281,8)),','(mvTrc(execCode(_h3279,_h3287,_h3327)),','(canAccessFile(_h3279,_h3287,_h3280,_h3281),assert_trace(because(8,rule_desc('execCode implies file access',certain),accessFile(_h3279,_h3280,_h3281),[canAccessFile(_h3279,_h3287,_h3280,_h3281),execCode(_h3279,_h3287)]))))).

:-(mvTrc(stolenCredential(_h3279,windows,9)),','(hasAccount(_h3279,_h3286,_h3287),','(mvTrc(execCode(_h3286,root,_h3339)),assert_trace(because(9,rule_desc('password sniffing',likely),stolenCredential(_h3279,windows),[execCode(_h3286,root),hasAccount(_h3279,_h3286,_h3287)]))))).

:-(mvTrc(logInService(_h3279,_h3280,_h3281,10)),','(networkServiceInfo(_h3279,sshd,_h3285),assert_trace(because(10,rule_desc('SSH is a login service',certain),logInService(_h3279,_h3280,_h3281),[networkServiceInfo(_h3279,sshd,_h3285)])))).

:-(mvTrc(logInService(_h3279,_h3280,_h3281,11)),','(networkServiceInfo(_h3279,vpnService,_h3285),assert_trace(because(11,rule_desc('VPN is a login service',certain),logInService(_h3279,_h3280,_h3281),[networkServiceInfo(_h3279,vpnService,_h3285)])))).

:-(mvTrc(accessFile(_h3279,_h3280,_h3281,12)),','(nfsMounted(_h3286,_h3287,_h3279,_h3281,_h3280),','(mvTrc(accessFile(_h3286,_h3280,_h3287,_h3343)),assert_trace(because(12,rule_desc('NFS semantics',certain),accessFile(_h3279,_h3280,_h3281),[accessFile(_h3286,_h3280,_h3287),nfsMounted(_h3286,_h3287,_h3279,_h3281,_h3280)]))))).

:-(mvTrc(accessFile(_h3279,_h3280,_h3281,13)),','(nfsMounted(_h3279,_h3281,_h3288,_h3289,read),','(mvTrc(accessFile(_h3288,_h3280,_h3289,_h3343)),assert_trace(because(13,rule_desc('NFS semantics',certain),accessFile(_h3279,_h3280,_h3281),[accessFile(_h3288,_h3280,_h3289),nfsMounted(_h3279,_h3281,_h3288,_h3289,read)]))))).

:-(mvTrc(accessFile(_h3279,_h3280,_h3281,14)),','(mvTrc(execCode(_h3286,_h3287,_h3335)),','(nfsExportInfo(_h3279,_h3281,_h3280,_h3286),','(hacl(_h3286,_h3279,nfsProtocol,nfsPort),assert_trace(because(14,rule_desc('NFS shell',likely),accessFile(_h3279,_h3280,_h3281),[hacl(_h3286,_h3279,nfsProtocol,nfsPort),nfsExportInfo(_h3279,_h3281,_h3280,_h3286),execCode(_h3286,_h3287)])))))).

:-(mvTrc(canAccessFile(_h3279,_h3280,_h3281,_h3282,15)),','(localFileProtection(_h3279,_h3280,_h3281,_h3282),assert_trace(because(15,rule_desc('file system access control',certain),canAccessFile(_h3279,_h3280,_h3281,_h3282),[localFileProtection(_h3279,_h3280,_h3281,_h3282)])))).

:-(mvTrc(vulnExists(_h3279,_h3280,_h3281,_h3282,_h3283,16)),','(vulExists(_h3279,_h3280,_h3281),','(vulProperty(_h3280,_h3282,_h3283),assert_trace(because(16,rule_desc('Vuln declared',certain),vulnExists(_h3279,_h3280,_h3281,_h3282,_h3283),[vulProperty(_h3280,_h3282,_h3283),vulExists(_h3279,_h3280,_h3281)]))))).

:-(mvTrc(vulnExists(_h3279,_h3280,_h3281,_h3282,_h3283,17)),','(mvTrc(vulnExists(_h3279,_h3280,_h3290,_h3282,_h3283,_h3331)),','(dependsOn(_h3279,_h3281,_h3290),assert_trace(because(17,rule_desc('Library bug',certain),vulnExists(_h3279,_h3280,_h3281,_h3282,_h3283),[dependsOn(_h3279,_h3281,_h3290),vulnExists(_h3279,_h3280,_h3290,_h3282,_h3283)]))))).

:-(mvTrc(accessMaliciousInput(_h3279,_h3280,_h3281,18)),','(inCompetent(_h3280),','(hacl(_h3279,_h3292,httpProtocol,httpPort),','(attackerLocated(_h3292),assert_trace(because(18,rule_desc('Browsing a malicious website',likely),accessMaliciousInput(_h3279,_h3280,_h3281),[attackerLocated(_h3292),hacl(_h3279,_h3292,httpProtocol,httpPort),inCompetent(_h3280)])))))).

:-(mvTrc(accessMaliciousInput(_h3279,_h3280,_h3281,19)),','(competent(_h3280),','(hacl(_h3279,_h3292,httpProtocol,httpPort),','(attackerLocated(_h3292),assert_trace(because(19,rule_desc('Browsing a malicious website',unlikely),accessMaliciousInput(_h3279,_h3280,_h3281),[attackerLocated(_h3292),hacl(_h3279,_h3292,httpProtocol,httpPort),competent(_h3280)])))))).

:-(mvTrc(accessMaliciousInput(_h3279,_h3280,_h3281,20)),','(inCompetent(_h3280),','(isWebServer(_h3291),','(hacl(_h3279,_h3291,httpProtocol,httpPort),','(mvTrc(execCode(_h3291,_h3302,_h3361)),assert_trace(because(20,rule_desc('Browsing a compromised website',possible),accessMaliciousInput(_h3279,_h3280,_h3281),[execCode(_h3291,_h3302),hacl(_h3279,_h3291,httpProtocol,httpPort),isWebServer(_h3291),inCompetent(_h3280)]))))))).

:-(mvTrc(userDefined(_h3279,_h3280,admin,21)),','(userDefined(_h3279,_h3287,domain_admin),','(hostDefined(_h3280,_h3287),assert_trace(because(21,rule_desc('Un admin de domain est admin local des machines du domain',certain),userDefined(_h3279,_h3280,admin),[hostDefined(_h3280,_h3287),userDefined(_h3279,_h3287,domain_admin)]))))).

:-(mvTrc(userFound(_h3279,_h3280,22)),','(userDefined(_h3279,_h3280,_h3287),','(mvTrc(netAccess(_h3292,_h3346)),','(mvTrc(vulnExists(_h3292,_h3298,_h3280,remoteExploit,accountEnumeration,_h3370)),','(cvss(_h3298,_h3304),assert_trace(because(22,rule_desc('User enumeration anonymously part2',cvss_ac(_h3304)),userFound(_h3279,_h3280),[cvss(_h3298,_h3304),vulnExists(_h3292,_h3298,_h3280,remoteExploit,accountEnumeration),netAccess(_h3292),userDefined(_h3279,_h3280,_h3287)]))))))).

:-(mvTrc(userFound(_h3279,_h3280,23)),','(userDefined(_h3279,_h3280,_h3287),','(mvTrc(netAccess(_h3280,_h3338)),assert_trace(because(23,rule_desc('Username found by brutforce',unlikely),userFound(_h3279,_h3280),[netAccess(_h3280),userDefined(_h3279,_h3280,_h3287)]))))).

:-(mvTrc(stolenCredential(_h3279,_h3280,24)),','(mvTrc(userFound(_h3279,_h3280,_h3323)),','(inCompetent(_h3279),assert_trace(because(24,rule_desc('password is user or in user description',likely),stolenCredential(_h3279,_h3280),[inCompetent(_h3279),userFound(_h3279,_h3280)]))))).

:-(mvTrc(stolenHash(_h3279,_h3280,25)),','(accessibleHash(_h3279,_h3280,asreproasting),','(mvTrc(netAccess(_h3280,_h3335)),','(mvTrc(userFound(_h3279,_h3280,_h3368)),assert_trace(because(25,rule_desc('asreproasting part2',likely),stolenHash(_h3279,_h3280),[userFound(_h3279,_h3280),netAccess(_h3280),accessibleHash(_h3279,_h3280,asreproasting)])))))).

:-(mvTrc(stolenCredential(_h3279,_h3280,26)),','(mvTrc(stolenHash(_h3279,_h3280,_h3323)),','(weakPassword(_h3279),assert_trace(because(26,rule_desc('Use of Hashcat for password crack',likely),stolenCredential(_h3279,_h3280),[weakPassword(_h3279),stolenHash(_h3279,_h3280)]))))).

:-(mvTrc(userFound(_h3279,_h3280,27)),','(userDefined(_h3279,_h3280,_h3287),','(mvTrc(stolenCredential(_h3292,_h3280,_h3335)),','(mvTrc(netAccess(_h3280,_h3373)),assert_trace(because(27,rule_desc('Username found after authentification',certain),userFound(_h3279,_h3280),[netAccess(_h3280),stolenCredential(_h3292,_h3280),userDefined(_h3279,_h3280,_h3287)])))))).

:-(mvTrc(stolenHash(_h3279,_h3280,28)),','(accessibleHash(_h3279,_h3280,kerberoasting),','(mvTrc(netAccess(_h3280,_h3335)),','(mvTrc(stolenCredential(_h3294,_h3280,_h3368)),assert_trace(because(28,rule_desc('Kerberoasting part 3',likely),stolenHash(_h3279,_h3280),[stolenCredential(_h3294,_h3280),netAccess(_h3280),accessibleHash(_h3279,_h3280,kerberoasting)])))))).

:-(mvTrc(stolenHash(_h3279,ntlmBot,29)),','(userPartOf(_h3279,runNTLMBot,user),','(isRuning(ntlmBot,_h3293),','(mvTrc(netAccess(_h3293,_h3349)),assert_trace(because(29,rule_desc('NTLM hash found part 4',likely),stolenHash(_h3279,ntlmBot),[netAccess(_h3293),isRuning(ntlmBot,_h3293),userPartOf(_h3279,runNTLMBot,user)])))))).

:-(mvTrc(stolenCredential(_h3279,_h3280,30)),','(userDefined(_h3279,_h3280,_h3287),','(weakPassword(_h3279),','(mvTrc(stolenHash(_h3279,ntlmBot,_h3349)),assert_trace(because(30,rule_desc('hashcat sur NTLM part 4 sachant que le user est trouve en meme temps que le hash',likely),stolenCredential(_h3279,_h3280),[stolenHash(_h3279,ntlmBot),weakPassword(_h3279),userDefined(_h3279,_h3280,_h3287)])))))).

:-(mvTrc(stolenHash(_h3279,_h3280,31)),','(mvTrc(vulnExists(_h3280,'Unsigned_SMB',signedSMB_false,remoteExploit,accessFile,_h3354)),','(mvTrc(stolenHash(_h3294,ntlmBot,_h3398)),','(userDefined(_h3294,_h3280,admin),','(accessibleHash(_h3279,_h3280,_h3280),','(mvTrc(netAccess(_h3280,_h3437)),','(cvss('Unsigned_SMB',_h3317),assert_trace(because(31,rule_desc('Use a socks relay with an admin account / part 4',cvss_ac(_h3317)),stolenHash(_h3279,_h3280),[cvss('Unsigned_SMB',_h3317),netAccess(_h3280),accessibleHash(_h3279,_h3280,_h3280),userDefined(_h3294,_h3280,admin),stolenHash(_h3294,ntlmBot),vulnExists(_h3280,'Unsigned_SMB',signedSMB_false,remoteExploit,accessFile)]))))))))).

:-(mvTrc(hasAccount(_h3279,_h3280,_h3281,32)),','(userDefined(_h3279,_h3287,_h3281),','(hostDefined(_h3280,_h3287),assert_trace(because(32,rule_desc('User defined',certain),hasAccount(_h3279,_h3280,_h3281),[hostDefined(_h3280,_h3287),userDefined(_h3279,_h3287,_h3281)]))))).

:-(mvTrc(execCode(_h3279,_h3280,_h3281,33)),','(hasAccount(_h3279,_h3280,_h3281),','(mvTrc(stolenCredential(_h3293,windows,_h3347)),','(hostDefined(_h3280,_h3300),','(mvTrc(netAccess(_h3300,_h3381)),','(rdpEnabled(_h3280),assert_trace(because(33,rule_desc('RDP access',certain),execCode(_h3279,_h3280,_h3281),[rdpEnabled(_h3280),netAccess(_h3300),hostDefined(_h3280,_h3300),stolenCredential(_h3293,windows),hasAccount(_h3279,_h3280,_h3281)])))))))).

:-(mvTrc(stolenCredential(_h3279,_h3280,34)),','(credentialInClear(_h3279,_h3286,_h3280),','(mvTrc(netAccess(_h3286,_h3338)),assert_trace(because(34,rule_desc('Use of DonPAPI',likely),stolenCredential(_h3279,_h3280),[netAccess(_h3286),credentialInClear(_h3279,_h3286,_h3280)]))))).

:-(mvTrc(isConnected(_h3279,_h3280,35)),','(hostDefined(_h3280,_h3286),','(userDefined(_h3279,_h3286,_h3290),assert_trace(because(35,rule_desc('Use a socks relay with an admin account / part 4',unlikely),isConnected(_h3279,_h3280),[userDefined(_h3279,_h3286,_h3290),hostDefined(_h3280,_h3286)]))))).

:-(mvTrc(dnsPoisoning(_h3279,36)),','(hostProperty(_h3279,automaticDNS,true),','(mvTrc(netAccess(_h3279,_h3337)),assert_trace(because(36,rule_desc('dns Poisoning',likely),dnsPoisoning(_h3279),[netAccess(_h3279),hostProperty(_h3279,automaticDNS,true)]))))).

:-(mvTrc(relayWPAD(_h3279,37)),','(mvTrc(dnsPoisoning(_h3279,_h3321)),','(mvTrc(netAccess(_h3279,_h3354)),assert_trace(because(37,rule_desc('relay the wpad http query to the ldaps',likely),relayWPAD(_h3279),[netAccess(_h3279),dnsPoisoning(_h3279)]))))).

:-(mvTrc(hostDefined(_h3279,_h3280,38)),','(hostDefined(_h3285,_h3280),','(mvTrc(relayWPAD(_h3285,_h3334)),','(userAdminOf(attacker,_h3279),assert_trace(because(38,rule_desc('relay the wpad http query to the ldaps',likely),hostDefined(_h3279,_h3280),[userAdminOf(attacker,_h3279),relayWPAD(_h3285),hostDefined(_h3285,_h3280)])))))).

:-(mvTrc(accessFile(_h3279,read,_h3281,39)),','(mvTrc(vulnExists(_h3279,_h3287,_h3288,remoteExploit,fileAccess,_h3348)),','(fileOnHost(_h3281,_h3279),','(cvss(_h3287,_h3302),','(mvTrc(stolenCredential(_h3307,_h3308,_h3402)),','(hostDefined(_h3279,_h3308),assert_trace(because(39,rule_desc('remote access file exploit',cvss_ac(_h3302)),accessFile(_h3279,read,_h3281),[hostDefined(_h3279,_h3308),stolenCredential(_h3307,_h3308),cvss(_h3287,_h3302),fileOnHost(_h3281,_h3279),vulnExists(_h3279,_h3287,_h3288,remoteExploit,fileAccess)])))))))).

:-(mvTrc(stolenHash(_h3279,_h3280,40)),','(mvTrc(vulnExists(_h3285,_h3286,_h3287,remoteExploit,accessLocalHash,_h3341)),','(accessibleHash(_h3279,_h3280,_h3285),','(cvss(_h3286,_h3302),','(mvTrc(netAccess(_h3285,_h3404)),assert_trace(because(40,rule_desc('remote access hash',cvss_ac(_h3302)),stolenHash(_h3279,_h3280),[netAccess(_h3285),cvss(_h3286,_h3302),accessibleHash(_h3279,_h3280,_h3285),vulnExists(_h3285,_h3286,_h3287,remoteExploit,accessLocalHash)]))))))).

:-(mvTrc(amsiBypass(_h3279,41)),','(mvTrc(netAccess(_h3279,_h3325)),assert_trace(because(41,rule_desc('amsi Bypass',likely),amsiBypass(_h3279),[netAccess(_h3279)])))).

:-(mvTrc(stolenHash(_h3279,_h3280,42)),','(accessibleHash(_h3279,_h3280,_h3287),','(userAdminOf(_h3292,_h3287),','(mvTrc(stolenCredential(_h3292,_h3299,_h3352)),','(hostDefined(_h3287,_h3299),','(mvTrc(netAccess(_h3287,_h3395)),assert_trace(because(42,rule_desc('secretsdump as local admin',certain),stolenHash(_h3279,_h3280),[netAccess(_h3287),hostDefined(_h3287,_h3299),stolenCredential(_h3292,_h3299),userAdminOf(_h3292,_h3287),accessibleHash(_h3279,_h3280,_h3287)])))))))).

:-(mvTrc(userAdminOf(_h3279,_h3280,43)),','(userPartOf(_h3279,_h3280,admin),assert_trace(because(43,rule_desc('User is admin',certain),userAdminOf(_h3279,_h3280),[userPartOf(_h3279,_h3280,admin)])))).

