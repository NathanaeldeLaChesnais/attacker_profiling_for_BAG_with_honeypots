primitive(inCompetent,1).
primitive(competent,1).
primitive(clientProgram,2).
primitive(vuln_exists,7).
primitive(vulExists,3).
primitive(vulProperty,3).
primitive(vulProperty,5).
primitive(hacl,4).
primitive(attackerLocated,1).
primitive(hasAccount,3).
primitive(networkServiceInfo,5).
primitive(setuidProgramInfo,3).
primitive(nfsExportInfo,4).
primitive(nfsMounted,5).
primitive(localFileProtection,4).
primitive(dependsOn,3).
primitive(installed,2).
primitive(isWebServer,1).
primitive(isUserMachine,1).
primitive(vulExists,5).
primitive(canAccessFile,4).
primitive(cvss,2).
derived(execCode,2).
derived(netAccess,3).
derived(canAccessHost,1).
derived(accessFile,3).
derived(principalCompromised,1).
derived(logInService,3).
derived(accessMaliciousInput,3).
meta(attackGoal,1).
meta(advances,2).

attack(execCode(hA,apacheRole)).

possible_duplicate_trace_step(because(6,rule_desc('direct network access',certain),netAccess(hA,tcp,80),[hacl(internet,hA,tcp,80),attackerLocated(internet)])).

possible_duplicate_trace_step(because(2,rule_desc('remote exploit of a server program',cvss_ac(none)),execCode(hA,apacheRole),[netAccess(hA,tcp,80),networkServiceInfo(hA,apache,tcp,80,apacheRole),cvss(log4j,none),vulExists(hA,log4j,apache,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(2,rule_desc('remote exploit of a server program',cvss_ac(h)),execCode(hA,apacheRole),[netAccess(hA,tcp,80),networkServiceInfo(hA,apache,tcp,80,apacheRole),cvss(log4j,h),vulExists(hA,log4j,apache,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(2,rule_desc('remote exploit of a server program',cvss_ac(h)),execCode(hA,apacheRole),[netAccess(hA,tcp,80),networkServiceInfo(hA,apache,tcp,80,apacheRole),cvss(log4j,h),vulExists(hA,log4j,apache,remoteExploit,privEscalation)])).

possible_duplicate_trace_step(because(2,rule_desc('remote exploit of a server program',cvss_ac(none)),execCode(hA,apacheRole),[netAccess(hA,tcp,80),networkServiceInfo(hA,apache,tcp,80,apacheRole),cvss(log4j,none),vulExists(hA,log4j,apache,remoteExploit,privEscalation)])).

